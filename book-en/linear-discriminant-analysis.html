<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Linear discriminant analysis | Workshop 10: Advanced Multivariate Analyses in R</title>
  <meta name="description" content="Advanced Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Linear discriminant analysis | Workshop 10: Advanced Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Advanced Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop10" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Linear discriminant analysis | Workshop 10: Advanced Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Advanced Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="multivariate-regression-tree.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series<span></span></b></span></li>
<li><a href="index.html#preface">Preface<span></span></a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>0.1</b> Code of conduct<span></span></a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour<span></span></a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour<span></span></a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors<span></span></a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing<span></span></a></li>
</ul></li>
<li class="part"><span><b>Advanced Multivariate Analyses in <code>R</code><span></span></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives<span></span></a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop<span></span></a></li>
<li class="chapter" data-level="3" data-path="why-advanced-multivariate-methods.html"><a href="why-advanced-multivariate-methods.html"><i class="fa fa-check"></i><b>3</b> Why “advanced multivariate methods”?<span></span></a></li>
<li class="chapter" data-level="4" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i><b>4</b> Exploring the Doubs River dataset<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="exploration.html"><a href="exploration.html#exploring-the-fish-community-dataset"><i class="fa fa-check"></i><b>4.1</b> Exploring the fish community dataset<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="exploration.html"><a href="exploration.html#exploring-the-environmental-dataset"><i class="fa fa-check"></i><b>4.2</b> Exploring the environmental dataset<span></span></a><ul>
<li class="chapter" data-level="4.2.1" data-path="exploration.html"><a href="exploration.html#collinearity"><i class="fa fa-check"></i><b>4.2.1</b> Collinearity<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="exploration.html"><a href="exploration.html#standardizing-the-environmental-variables"><i class="fa fa-check"></i><b>4.2.2</b> Standardizing the environmental variables<span></span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Constrained ordinations<span></span></b></span></li>
<li class="chapter" data-level="5" data-path="what-are-constrained-ordinations.html"><a href="what-are-constrained-ordinations.html"><i class="fa fa-check"></i><b>5</b> What are “constrained” ordinations?<span></span></a></li>
<li class="chapter" data-level="6" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html"><i class="fa fa-check"></i><b>6</b> Redundancy analysis<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#how-the-rda-works"><i class="fa fa-check"></i><b>6.1</b> How the RDA works<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#running-an-rda-in-r"><i class="fa fa-check"></i><b>6.2</b> Running an RDA in R<span></span></a><ul>
<li class="chapter" data-level="6.2.1" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#selecting-variables"><i class="fa fa-check"></i><b>6.2.1</b> Selecting variables<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#significance-testing"><i class="fa fa-check"></i><b>6.2.2</b> Significance testing<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#rda-plot"><i class="fa fa-check"></i><b>6.2.3</b> RDA plot<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#challenge-1"><i class="fa fa-check"></i><b>6.3</b> Challenge 1<span></span></a><ul>
<li class="chapter" data-level="6.3.1" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html#challenge-1-solution"><i class="fa fa-check"></i><b>6.3.1</b> Challenge 1: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html"><i class="fa fa-check"></i><b>7</b> Partial Redundancy Analysis<span></span></a><ul>
<li class="chapter" data-level="7.1" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html#example-partial-rda-on-doubs-river-data"><i class="fa fa-check"></i><b>7.1</b> Example: Partial RDA on Doubs River data<span></span></a><ul>
<li class="chapter" data-level="7.1.1" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html#interpreting-partial-rda-output-in-r"><i class="fa fa-check"></i><b>7.1.1</b> Interpreting partial RDA output in R<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html#significance-testing-1"><i class="fa fa-check"></i><b>7.1.2</b> Significance testing<span></span></a></li>
<li class="chapter" data-level="7.1.3" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html#partial-rda-plot"><i class="fa fa-check"></i><b>7.1.3</b> Partial RDA plot<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html#challenge-2"><i class="fa fa-check"></i><b>7.2</b> Challenge 2<span></span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html#challenge-2-solution"><i class="fa fa-check"></i><b>7.2.1</b> Challenge 2: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="variation-partitioning.html"><a href="variation-partitioning.html"><i class="fa fa-check"></i><b>8</b> Variation partitioning<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="variation-partitioning.html"><a href="variation-partitioning.html#variation-partitioning-in-r"><i class="fa fa-check"></i><b>8.1</b> Variation partitioning in R<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="variation-partitioning.html"><a href="variation-partitioning.html#significance-testing-2"><i class="fa fa-check"></i><b>8.2</b> Significance testing<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="variation-partitioning.html"><a href="variation-partitioning.html#challenge-3"><i class="fa fa-check"></i><b>8.3</b> Challenge 3<span></span></a><ul>
<li class="chapter" data-level="8.3.1" data-path="variation-partitioning.html"><a href="variation-partitioning.html#challenge-3-solution"><i class="fa fa-check"></i><b>8.3.1</b> Challenge 3: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html"><i class="fa fa-check"></i><b>9</b> Multivariate regression tree<span></span></a><ul>
<li class="chapter" data-level="9.1" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#computing-the-mrt"><i class="fa fa-check"></i><b>9.1</b> Computing the MRT<span></span></a><ul>
<li class="chapter" data-level="9.1.1" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#building-the-tree-constrained-partitioning-of-the-data"><i class="fa fa-check"></i><b>9.1.1</b> Building the tree: Constrained partitioning of the data<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#selecting-the-tree-cross-validation-and-pruning"><i class="fa fa-check"></i><b>9.1.2</b> Selecting the tree: Cross-validation and pruning<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#mrt-in-r"><i class="fa fa-check"></i><b>9.2</b> MRT in R<span></span></a><ul>
<li class="chapter" data-level="9.2.1" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#mrt-selection-process"><i class="fa fa-check"></i><b>9.2.1</b> MRT selection process<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#interpreting-mrt-output"><i class="fa fa-check"></i><b>9.2.2</b> Interpreting MRT output<span></span></a></li>
<li class="chapter" data-level="9.2.3" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#indicator-species"><i class="fa fa-check"></i><b>9.2.3</b> Indicator species<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#challenge-4"><i class="fa fa-check"></i><b>9.3</b> Challenge 4<span></span></a><ul>
<li class="chapter" data-level="9.3.1" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html#challenge-4-solution"><i class="fa fa-check"></i><b>9.3.1</b> Challenge 4: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html"><i class="fa fa-check"></i><b>10</b> Linear discriminant analysis<span></span></a><ul>
<li class="chapter" data-level="10.1" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#lda-in-r-doubs-river-fish-dataset"><i class="fa fa-check"></i><b>10.1</b> LDA in R: Doubs River fish dataset<span></span></a><ul>
<li class="chapter" data-level="10.1.1" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#making-a-priori-groupings"><i class="fa fa-check"></i><b>10.1.1</b> Making <em>a priori</em> groupings<span></span></a></li>
<li class="chapter" data-level="10.1.2" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#running-the-lda"><i class="fa fa-check"></i><b>10.1.2</b> Running the LDA<span></span></a></li>
<li class="chapter" data-level="10.1.3" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#evaluating-grouping-accuracy"><i class="fa fa-check"></i><b>10.1.3</b> Evaluating grouping accuracy<span></span></a></li>
<li class="chapter" data-level="10.1.4" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#predictions"><i class="fa fa-check"></i><b>10.1.4</b> Predictions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html#challenge-5"><i class="fa fa-check"></i><b>10.2</b> Challenge 5<span></span></a></li>
</ul></li>
<li class="part"><span><b>Final considerations<span></span></b></span></li>
<li class="chapter" data-level="11" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>11</b> Summary<span></span></a></li>
<li class="chapter" data-level="12" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>12</b> Additional resources<span></span></a></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 10: Advanced Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="linear-discriminant-analysis" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 10</span> Linear discriminant analysis<a href="linear-discriminant-analysis.html#linear-discriminant-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Linear discriminant analysis (LDA) is a constrained (canonical) technique that divides a response mtrix into groups according to a factor by finding combination of the variables that give <strong>best possible separation between groups.</strong> The grouping is done by maximizing the among-group dispersion versus the within-group dispersion. This allows you to determine how well your independent set of variables explains an <em>a priori</em> grouping, which may have been obtained from a previous clustering analysis (see <a href="https://github.com/QCBSRworkshops/workshop09">Workshop 9</a>) or from a hypothesis (e.g. grouping is based on sites at different latitudes or different treatments).</p>
<p>An LDA computes discriminant functions from standardized descriptors. These coefficients quantify the relative contributions of the (standardized) explanatory variables to the discrimination of objects. Identification functions can be computed from the original (not standardized) descriptors to <strong>classify new data into pre-determined groups</strong>. There are several useful applications of this capacity to predict groupings, such as assessing which population a fish should be classified in based on morphology or classifying whether a new paper is a freshwater, marine or terrestrial study based on the abstract of papers in those pre-determined biomes.</p>
<div id="lda-in-r-doubs-river-fish-dataset" class="section level2 hasAnchor">
<h2><span class="header-section-number">10.1</span> LDA in R: Doubs River fish dataset<a href="linear-discriminant-analysis.html#lda-in-r-doubs-river-fish-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will continue to work with the Doubs River fish dataset to demonstrate how to implement a linear discriminant analysis in <code>R</code>.</p>
<div id="making-a-priori-groupings" class="section level3 hasAnchor">
<h3><span class="header-section-number">10.1.1</span> Making <em>a priori</em> groupings<a href="linear-discriminant-analysis.html#making-a-priori-groupings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we want to make an <em>a priori</em> classification that is independent from the environmental data set. We know that environmental variables generally change with latitude. This might lead us to ask the following question: <strong>If we classify our Doubs River sites according to latitude, how well do environmental variables explain these groupings?</strong> To answer this question, we can make <em>a priori</em> groups by simply dividing the range of latitudes equally into three groups, and assigning each site to a group depending on where they fall along the divided range.</p>
<p>Let us begin by loading spatial coordinates for the Doubs River sites.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="linear-discriminant-analysis.html#cb119-1"></a><span class="co"># load spatial data for Doubs sites</span></span>
<span id="cb119-2"><a href="linear-discriminant-analysis.html#cb119-2"></a>spa &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/doubsspa.csv&quot;</span>, <span class="dt">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb119-3"><a href="linear-discriminant-analysis.html#cb119-3"></a>spa<span class="op">$</span>site &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(spa)  <span class="co"># add site numbers</span></span>
<span id="cb119-4"><a href="linear-discriminant-analysis.html#cb119-4"></a>spa &lt;-<span class="st"> </span>spa[<span class="op">-</span><span class="dv">8</span>, ]  <span class="co"># remove site 8</span></span></code></pre></div>
<p>We can then assign sites into three groups based on their latitude.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="linear-discriminant-analysis.html#cb120-1"></a><span class="co"># group sites based on latitude</span></span>
<span id="cb120-2"><a href="linear-discriminant-analysis.html#cb120-2"></a>spa<span class="op">$</span>group &lt;-<span class="st"> </span><span class="ot">NA</span>  <span class="co"># create &#39;group&#39; column</span></span>
<span id="cb120-3"><a href="linear-discriminant-analysis.html#cb120-3"></a>spa<span class="op">$</span>group[<span class="kw">which</span>(spa<span class="op">$</span>y <span class="op">&lt;</span><span class="st"> </span><span class="dv">82</span>)] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb120-4"><a href="linear-discriminant-analysis.html#cb120-4"></a>spa<span class="op">$</span>group[<span class="kw">which</span>(spa<span class="op">$</span>y <span class="op">&gt;</span><span class="st"> </span><span class="dv">82</span> <span class="op">&amp;</span><span class="st"> </span>spa<span class="op">$</span>y <span class="op">&lt;</span><span class="st"> </span><span class="dv">156</span>)] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb120-5"><a href="linear-discriminant-analysis.html#cb120-5"></a>spa<span class="op">$</span>group[<span class="kw">which</span>(spa<span class="op">$</span>y <span class="op">&gt;</span><span class="st"> </span><span class="dv">156</span>)] &lt;-<span class="st"> </span><span class="dv">3</span></span></code></pre></div>
<p>Let us quickly plot the latitude groupings to see if they make sense.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="linear-discriminant-analysis.html#cb121-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> spa) <span class="op">+</span></span>
<span id="cb121-2"><a href="linear-discriminant-analysis.html#cb121-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, </span>
<span id="cb121-3"><a href="linear-discriminant-analysis.html#cb121-3"></a>                 <span class="dt">y =</span> y, </span>
<span id="cb121-4"><a href="linear-discriminant-analysis.html#cb121-4"></a>                 <span class="dt">col =</span> <span class="kw">as.factor</span>(group)), </span>
<span id="cb121-5"><a href="linear-discriminant-analysis.html#cb121-5"></a>             <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb121-6"><a href="linear-discriminant-analysis.html#cb121-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Groups&quot;</span>, </span>
<span id="cb121-7"><a href="linear-discriminant-analysis.html#cb121-7"></a>       <span class="dt">x =</span> <span class="st">&quot;Longitude&quot;</span>, </span>
<span id="cb121-8"><a href="linear-discriminant-analysis.html#cb121-8"></a>       <span class="dt">y =</span> <span class="st">&quot;Latitude&quot;</span>) <span class="op">+</span></span>
<span id="cb121-9"><a href="linear-discriminant-analysis.html#cb121-9"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#3b5896&quot;</span>, <span class="st">&quot;#e3548c&quot;</span>, <span class="st">&quot;#ffa600&quot;</span>)) <span class="op">+</span></span>
<span id="cb121-10"><a href="linear-discriminant-analysis.html#cb121-10"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co"># formatting the plot to make it pretty</span></span>
<span id="cb121-11"><a href="linear-discriminant-analysis.html#cb121-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</span>
<span id="cb121-12"><a href="linear-discriminant-analysis.html#cb121-12"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</span>
<span id="cb121-13"><a href="linear-discriminant-analysis.html#cb121-13"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</span>
<span id="cb121-14"><a href="linear-discriminant-analysis.html#cb121-14"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>))</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-88-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now that we have our <em>a priori</em> groups, we would usually need to ensure the data meets a condition necessary for the application of LDA: the within-group covariance matrices of the explanatory variables must be homogeneous. To do this, we would use the <code>betadisper()</code> function in the <code>vegan</code> package to check the multivariate homogeneity of within-group variances before proceeding, as seen in <span class="citation">Borcard, Gillet, and Legendre (<a href="#ref-borcard2011" role="doc-biblioref">2011</a>)</span>. For the purposes of this workshop, we will move straight to doing the LDA.</p>
</div>
<div id="running-the-lda" class="section level3 hasAnchor">
<h3><span class="header-section-number">10.1.2</span> Running the LDA<a href="linear-discriminant-analysis.html#running-the-lda" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="linear-discriminant-analysis.html#cb122-1"></a><span class="co"># run the LDA grouping sites into latitude groups based on</span></span>
<span id="cb122-2"><a href="linear-discriminant-analysis.html#cb122-2"></a><span class="co"># env data</span></span>
<span id="cb122-3"><a href="linear-discriminant-analysis.html#cb122-3"></a>LDA &lt;-<span class="st"> </span><span class="kw">lda</span>(env, spa<span class="op">$</span>group)</span></code></pre></div>
<p>Our sites have now been reorganised into groups that are as distinct as possible, based on the environmental variables. We can plot the reorganised sites to visualise the results of the LDA.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="linear-discriminant-analysis.html#cb123-1"></a><span class="co"># predict the groupings</span></span>
<span id="cb123-2"><a href="linear-discriminant-analysis.html#cb123-2"></a>lda.plotdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">group =</span> spa<span class="op">$</span>group, <span class="dt">lda =</span> <span class="kw">predict</span>(LDA)<span class="op">$</span>x)</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="linear-discriminant-analysis.html#cb124-1"></a><span class="co"># Plot the newly reorganised sites according to the LDA</span></span>
<span id="cb124-2"><a href="linear-discriminant-analysis.html#cb124-2"></a><span class="kw">ggplot</span>(lda.plotdf) <span class="op">+</span></span>
<span id="cb124-3"><a href="linear-discriminant-analysis.html#cb124-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lda.LD1, </span>
<span id="cb124-4"><a href="linear-discriminant-analysis.html#cb124-4"></a>                 <span class="dt">y =</span> lda.LD2, </span>
<span id="cb124-5"><a href="linear-discriminant-analysis.html#cb124-5"></a>                 <span class="dt">col =</span> <span class="kw">factor</span>(group)), </span>
<span id="cb124-6"><a href="linear-discriminant-analysis.html#cb124-6"></a>             <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb124-7"><a href="linear-discriminant-analysis.html#cb124-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Groups&quot;</span>) <span class="op">+</span></span>
<span id="cb124-8"><a href="linear-discriminant-analysis.html#cb124-8"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#3b5896&quot;</span>, <span class="st">&quot;#e3548c&quot;</span>, <span class="st">&quot;#ffa600&quot;</span>)) <span class="op">+</span></span>
<span id="cb124-9"><a href="linear-discriminant-analysis.html#cb124-9"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co"># formatting the plot to make it pretty</span></span>
<span id="cb124-10"><a href="linear-discriminant-analysis.html#cb124-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</span>
<span id="cb124-11"><a href="linear-discriminant-analysis.html#cb124-11"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</span>
<span id="cb124-12"><a href="linear-discriminant-analysis.html#cb124-12"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</span>
<span id="cb124-13"><a href="linear-discriminant-analysis.html#cb124-13"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>))</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-91-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="evaluating-grouping-accuracy" class="section level3 hasAnchor">
<h3><span class="header-section-number">10.1.3</span> Evaluating grouping accuracy<a href="linear-discriminant-analysis.html#evaluating-grouping-accuracy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once we run the LDA, we can use the result object to determine:</p>
<ul>
<li>How sites are grouped based on the the environmental data, according to the LDA;<br />
</li>
<li>The posterior probabilities of that the sites to belong to the groups;<br />
</li>
<li>The percentage of correct classification based on our latitudinal grouping.</li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="linear-discriminant-analysis.html#cb125-1"></a><span class="co"># Classification of the objects based on the LDA</span></span>
<span id="cb125-2"><a href="linear-discriminant-analysis.html#cb125-2"></a>spe.class &lt;-<span class="st"> </span><span class="kw">predict</span>(LDA)<span class="op">$</span>class</span>
<span id="cb125-3"><a href="linear-discriminant-analysis.html#cb125-3"></a></span>
<span id="cb125-4"><a href="linear-discriminant-analysis.html#cb125-4"></a><span class="co"># Posterior probabilities that the objects belong to those</span></span>
<span id="cb125-5"><a href="linear-discriminant-analysis.html#cb125-5"></a><span class="co"># groups</span></span>
<span id="cb125-6"><a href="linear-discriminant-analysis.html#cb125-6"></a>spe.post &lt;-<span class="st"> </span><span class="kw">predict</span>(LDA)<span class="op">$</span>posterior</span>
<span id="cb125-7"><a href="linear-discriminant-analysis.html#cb125-7"></a></span>
<span id="cb125-8"><a href="linear-discriminant-analysis.html#cb125-8"></a><span class="co"># Table of prior vs. predicted classifications</span></span>
<span id="cb125-9"><a href="linear-discriminant-analysis.html#cb125-9"></a>(spe.table &lt;-<span class="st"> </span><span class="kw">table</span>(spa<span class="op">$</span>group, spe.class))</span></code></pre></div>
<pre><code>##    spe.class
##      1  2  3
##   1  7  0  0
##   2  0  6  0
##   3  0  0 16</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="linear-discriminant-analysis.html#cb127-1"></a><span class="co"># Proportion of corrected classification</span></span>
<span id="cb127-2"><a href="linear-discriminant-analysis.html#cb127-2"></a><span class="kw">diag</span>(<span class="kw">prop.table</span>(spe.table, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## 1 2 3 
## 1 1 1</code></pre>
<p>All sites were correctly classified (<em>Proportion of corrected classification = 1</em>) into the latitude groups based on environmental variables.</p>
</div>
<div id="predictions" class="section level3 hasAnchor">
<h3><span class="header-section-number">10.1.4</span> Predictions<a href="linear-discriminant-analysis.html#predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can now use this relationship to classify <strong>new</strong> sites into latitude groups, based on the relationship we have established between our latitudinal grouping and environmental factors using the LDA.</p>
<p>Let us predict the groupings of <strong>five</strong> new sites in the dummy dataset <code>classifyme.csv</code> using the LDA object we computed above. To do this, we will use the <code>predict()</code> function.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="linear-discriminant-analysis.html#cb129-1"></a><span class="co"># Load the new site data</span></span>
<span id="cb129-2"><a href="linear-discriminant-analysis.html#cb129-2"></a>classify.me &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/classifyme.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb129-3"><a href="linear-discriminant-analysis.html#cb129-3"></a><span class="co"># remove das</span></span>
<span id="cb129-4"><a href="linear-discriminant-analysis.html#cb129-4"></a>classify.me &lt;-<span class="st"> </span><span class="kw">subset</span>(classify.me, <span class="dt">select =</span> <span class="op">-</span>das)</span>
<span id="cb129-5"><a href="linear-discriminant-analysis.html#cb129-5"></a></span>
<span id="cb129-6"><a href="linear-discriminant-analysis.html#cb129-6"></a><span class="co"># Predict grouping of new sites</span></span>
<span id="cb129-7"><a href="linear-discriminant-analysis.html#cb129-7"></a>predict.group &lt;-<span class="st"> </span><span class="kw">predict</span>(LDA, <span class="dt">newdata =</span> classify.me)</span>
<span id="cb129-8"><a href="linear-discriminant-analysis.html#cb129-8"></a></span>
<span id="cb129-9"><a href="linear-discriminant-analysis.html#cb129-9"></a><span class="co"># View site classification</span></span>
<span id="cb129-10"><a href="linear-discriminant-analysis.html#cb129-10"></a>predict.group<span class="op">$</span>class</span></code></pre></div>
<pre><code>## [1] 1 1 1 3 3
## Levels: 1 2 3</code></pre>
<p>Our new sites, in order, have been classified in groups 1, 1, 1, 3 and 3 respectively.</p>
</div>
</div>
<div id="challenge-5" class="section level2 hasAnchor">
<h2><span class="header-section-number">10.2</span> Challenge 5<a href="linear-discriminant-analysis.html#challenge-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Create four equally-spaced latitude groups in the <code>mite.xy</code> dataset. Then, run an LDA to classify mite sites into latitude groupings based on environmental variables (<code>SubsDens</code> and <code>WatrCont</code>). <strong>What proportion of sites was correctly classified in group1? in group2?</strong></p>
<p>To begin, load the <code>mite.xy</code> data:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="linear-discriminant-analysis.html#cb131-1"></a><span class="kw">data</span>(mite.xy)</span></code></pre></div>
<p>Recall some useful functions:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="linear-discriminant-analysis.html#cb132-1"></a><span class="kw">lda</span>()</span>
<span id="cb132-2"><a href="linear-discriminant-analysis.html#cb132-2"></a><span class="kw">predict</span>()</span>
<span id="cb132-3"><a href="linear-discriminant-analysis.html#cb132-3"></a><span class="kw">table</span>()</span>
<span id="cb132-4"><a href="linear-discriminant-analysis.html#cb132-4"></a><span class="kw">diag</span>()</span></code></pre></div>
<p><strong>Step 1:</strong> Make four equally spaced latitude groups.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="linear-discriminant-analysis.html#cb133-1"></a><span class="co"># assign numbers to sites</span></span>
<span id="cb133-2"><a href="linear-discriminant-analysis.html#cb133-2"></a>mite.xy<span class="op">$</span>site &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mite.xy)</span>
<span id="cb133-3"><a href="linear-discriminant-analysis.html#cb133-3"></a></span>
<span id="cb133-4"><a href="linear-discriminant-analysis.html#cb133-4"></a><span class="co"># figure out the spacing to make 4 equally spaced latitude</span></span>
<span id="cb133-5"><a href="linear-discriminant-analysis.html#cb133-5"></a><span class="co"># groups</span></span>
<span id="cb133-6"><a href="linear-discriminant-analysis.html#cb133-6"></a>(<span class="kw">max</span>(mite.xy[, <span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(mite.xy[, <span class="dv">2</span>]))<span class="op">/</span><span class="dv">4</span></span></code></pre></div>
<pre><code>## [1] 2.4</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="linear-discriminant-analysis.html#cb135-1"></a><span class="co"># use this to group sites into 4 latitude groups</span></span>
<span id="cb135-2"><a href="linear-discriminant-analysis.html#cb135-2"></a>mite.xy<span class="op">$</span>group &lt;-<span class="st"> </span><span class="ot">NA</span>  <span class="co"># create &#39;group&#39; column</span></span>
<span id="cb135-3"><a href="linear-discriminant-analysis.html#cb135-3"></a>mite.xy<span class="op">$</span>group[<span class="kw">which</span>(mite.xy<span class="op">$</span>y <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.5</span>)] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb135-4"><a href="linear-discriminant-analysis.html#cb135-4"></a>mite.xy<span class="op">$</span>group[<span class="kw">which</span>(mite.xy<span class="op">$</span>y <span class="op">&gt;=</span><span class="st"> </span><span class="fl">2.5</span> <span class="op">&amp;</span><span class="st"> </span>mite.xy<span class="op">$</span>y <span class="op">&lt;</span><span class="st"> </span><span class="fl">4.9</span>)] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb135-5"><a href="linear-discriminant-analysis.html#cb135-5"></a>mite.xy<span class="op">$</span>group[<span class="kw">which</span>(mite.xy<span class="op">$</span>y <span class="op">&gt;=</span><span class="st"> </span><span class="fl">4.9</span> <span class="op">&amp;</span><span class="st"> </span>mite.xy<span class="op">$</span>y <span class="op">&lt;</span><span class="st"> </span><span class="fl">7.3</span>)] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb135-6"><a href="linear-discriminant-analysis.html#cb135-6"></a>mite.xy<span class="op">$</span>group[<span class="kw">which</span>(mite.xy<span class="op">$</span>y <span class="op">&gt;=</span><span class="st"> </span><span class="fl">7.3</span>)] &lt;-<span class="st"> </span><span class="dv">4</span></span></code></pre></div>
<p><strong>Step 2:</strong> Run the LDA.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="linear-discriminant-analysis.html#cb136-1"></a>LDA.mite &lt;-<span class="st"> </span><span class="kw">lda</span>(mite.env[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], mite.xy<span class="op">$</span>group)</span></code></pre></div>
<p><strong>Step 3:</strong> Check whether the groupings are correct.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="linear-discriminant-analysis.html#cb137-1"></a><span class="co"># group sites based on the LDA</span></span>
<span id="cb137-2"><a href="linear-discriminant-analysis.html#cb137-2"></a>mite.class &lt;-<span class="st"> </span><span class="kw">predict</span>(LDA.mite)<span class="op">$</span>class</span>
<span id="cb137-3"><a href="linear-discriminant-analysis.html#cb137-3"></a></span>
<span id="cb137-4"><a href="linear-discriminant-analysis.html#cb137-4"></a><span class="co"># get the table of prior versus predicted classifications</span></span>
<span id="cb137-5"><a href="linear-discriminant-analysis.html#cb137-5"></a>(mite.table &lt;-<span class="st"> </span><span class="kw">table</span>(mite.xy<span class="op">$</span>group, mite.class))</span></code></pre></div>
<pre><code>##    mite.class
##      1  2  3  4
##   1  9  4  2  0
##   2  2 11  4  0
##   3  1  2 14  2
##   4  0  0  3 16</code></pre>
<p>We can answer the challenge question with this part:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="linear-discriminant-analysis.html#cb139-1"></a><span class="co"># proportion of correct classification</span></span>
<span id="cb139-2"><a href="linear-discriminant-analysis.html#cb139-2"></a><span class="kw">diag</span>(<span class="kw">prop.table</span>(mite.table, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         1         2         3         4 
## 0.6000000 0.6470588 0.7368421 0.8421053</code></pre>
<p><strong>So, what proportion of sites was correctly classified in group1? in group2?</strong></p>
<ul>
<li><strong>60%</strong> were correctly classified into group1, and <strong>64.7%</strong> were classified into group2.</li>
</ul>

</div>
</div>



<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references">
<div id="ref-borcard2011">
<p>Borcard, Daniel, François Gillet, and Pierre Legendre. 2011. <em>Numerical Ecology with R</em>. Use R! New York: Springer-Verlag. <a href="https://doi.org/10.1007/978-1-4419-7976-6">https://doi.org/10.1007/978-1-4419-7976-6</a>.</p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-regression-tree.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
