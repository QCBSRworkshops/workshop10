<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Variation partitioning | Workshop 10: Advanced Multivariate Analyses in R</title>
  <meta name="description" content="Advanced Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Variation partitioning | Workshop 10: Advanced Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Advanced Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop10" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Variation partitioning | Workshop 10: Advanced Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Advanced Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="partial-redundancy-analysis.html"/>
<link rel="next" href="multivariate-regression-tree.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Advanced Multivariate Analyses in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="why-advanced-multivariate-methods.html"><a href="why-advanced-multivariate-methods.html"><i class="fa fa-check"></i><b>3</b> Why “advanced multivariate methods”?</a></li>
<li class="chapter" data-level="4" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html"><i class="fa fa-check"></i><b>4</b> Exploring the dataset</a><ul>
<li class="chapter" data-level="4.1" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#species-data"><i class="fa fa-check"></i><b>4.1</b> Species data</a></li>
<li class="chapter" data-level="4.2" data-path="exploring-the-dataset.html"><a href="exploring-the-dataset.html#environmental-data"><i class="fa fa-check"></i><b>4.2</b> Environmental data</a></li>
</ul></li>
<li class="part"><span><b>Constrained ordinations</b></span></li>
<li class="chapter" data-level="5" data-path="what-are-constrained-ordinations.html"><a href="what-are-constrained-ordinations.html"><i class="fa fa-check"></i><b>5</b> What are “constrained” ordinations?</a></li>
<li class="chapter" data-level="6" data-path="redundancy-analysis.html"><a href="redundancy-analysis.html"><i class="fa fa-check"></i><b>6</b> Redundancy analysis</a></li>
<li class="chapter" data-level="7" data-path="partial-redundancy-analysis.html"><a href="partial-redundancy-analysis.html"><i class="fa fa-check"></i><b>7</b> Partial Redundancy Analysis</a></li>
<li class="chapter" data-level="8" data-path="variation-partitioning.html"><a href="variation-partitioning.html"><i class="fa fa-check"></i><b>8</b> Variation partitioning</a></li>
<li class="chapter" data-level="9" data-path="multivariate-regression-tree.html"><a href="multivariate-regression-tree.html"><i class="fa fa-check"></i><b>9</b> Multivariate regression tree</a></li>
<li class="chapter" data-level="10" data-path="linear-discriminant-analysis.html"><a href="linear-discriminant-analysis.html"><i class="fa fa-check"></i><b>10</b> Linear discriminant analysis</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="11" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>11</b> Summary</a></li>
<li class="chapter" data-level="12" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>12</b> Additional resources</a></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 10: Advanced Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="variation-partitioning" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Variation partitioning</h1>
<p>Variation partitioning is a type of analysis that combines RDA and
partial RDA to divide the variation of a response variable among two,
three or four explanatory data sets. Variation partitioning are
generally represented by Venn diagram in which the percentage of
explained variance by each explanatory data set (or combination of data
stets) is reported.</p>
<p>In the case of two datasets (below): - Fraction a + b +c is the
explained variance by the two datasets calculated using a RDA of y by X
+ W. - Fraction d is the unexplained variance by the two datasets
calculated using the same RDA as above. - Fraction a is the explained
variance by the X data set only calculated using a partial of y by X
with W as covariables. - Fraction c is the explained variance by the W
data set only calculated using a partial of y by W with X as
covariables. - Fraction b is calculated by subtraction, i.e. b = <span class="math display">\[a +
b\]</span> + <span class="math display">\[b + c\]</span> - <span class="math display">\[a + b + c\]</span>.</p>
<p><img src="images/vennd_varpart.png" class="align-center" /></p>
<p>Venn diagram of partition of the variation of a response variable y
among two sets of explanatory variables X and W (from Legendre and
Legendre 2012).</p>
<p>Variation partitioning is thus an indicated analysis when user what to
relate the abundance of species in a community to various type of
environmental variables, for example abiotic vs biotic variables,
large-scale versus small-scale variables, etc. In the next example, we
will partition the variation of fish species composition between
chemical and physiographic variables.</p>
<p>In R, variation partitioning is performed using the function varpart().
Venn diagrams can also be drawn using the function plot().</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="variation-partitioning.html#cb20-1"></a><span class="st">`</span><span class="dt">?</span><span class="st">`</span>(varpart)</span>
<span id="cb20-2"><a href="variation-partitioning.html#cb20-2"></a><span class="kw">vegandocs</span>(<span class="st">&quot;partitioning.pdf&quot;</span>)</span>
<span id="cb20-3"><a href="variation-partitioning.html#cb20-3"></a></span>
<span id="cb20-4"><a href="variation-partitioning.html#cb20-4"></a><span class="co"># Variation partitioning with all explanatory variables</span></span>
<span id="cb20-5"><a href="variation-partitioning.html#cb20-5"></a>spe.part.all &lt;-<span class="st"> </span><span class="kw">varpart</span>(spe.hel, envchem, envtopo)</span>
<span id="cb20-6"><a href="variation-partitioning.html#cb20-6"></a>spe.part.all</span>
<span id="cb20-7"><a href="variation-partitioning.html#cb20-7"></a><span class="kw">windows</span>(<span class="dt">title =</span> <span class="st">&quot;Variation partitioning - all variables&quot;</span>)</span>
<span id="cb20-8"><a href="variation-partitioning.html#cb20-8"></a><span class="kw">plot</span>(spe.part.all, <span class="dt">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The output looks like: <img src="images/varpart_output.png" class="align-center" />
<img src="images/varpart_output_venn.png" class="align-center" /></p>
<p>In this case, the chemical variables explain 24.10% of the fish species
composition, the physiographic variables explain 11.20% of the fish
species composition and the interaction of these two types of variables
explained 23.30% of the fish species composition. Note that the
varpart() function also identify the fractions that can be tested for
significance using the function anova.cca().</p>
<p>Users can also perform variation partitioning between data sets that
only contain significant environmental variables:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="variation-partitioning.html#cb21-1"></a><span class="co"># RDA of chemistry variables</span></span>
<span id="cb21-2"><a href="variation-partitioning.html#cb21-2"></a>spe.chem &lt;-<span class="st"> </span><span class="kw">rda</span>(spe.hel <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> envchem)</span>
<span id="cb21-3"><a href="variation-partitioning.html#cb21-3"></a></span>
<span id="cb21-4"><a href="variation-partitioning.html#cb21-4"></a><span class="co"># Select significant chemistry variables</span></span>
<span id="cb21-5"><a href="variation-partitioning.html#cb21-5"></a>R2a.all.chem &lt;-<span class="st"> </span><span class="kw">RsquareAdj</span>(spe.chem)<span class="op">$</span>adj.r.squared</span>
<span id="cb21-6"><a href="variation-partitioning.html#cb21-6"></a><span class="kw">ordiR2step</span>(<span class="kw">rda</span>(spe.hel <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> envchem), <span class="dt">scope =</span> <span class="kw">formula</span>(spe.chem), </span>
<span id="cb21-7"><a href="variation-partitioning.html#cb21-7"></a>    <span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="dt">R2scope =</span> <span class="ot">TRUE</span>, <span class="dt">pstep =</span> <span class="dv">1000</span>)</span>
<span id="cb21-8"><a href="variation-partitioning.html#cb21-8"></a><span class="kw">names</span>(envchem)</span>
<span id="cb21-9"><a href="variation-partitioning.html#cb21-9"></a>(envchem.pars &lt;-<span class="st"> </span>envchem[, <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>)])</span>
<span id="cb21-10"><a href="variation-partitioning.html#cb21-10"></a></span>
<span id="cb21-11"><a href="variation-partitioning.html#cb21-11"></a><span class="co"># RDA with other environmental variables</span></span>
<span id="cb21-12"><a href="variation-partitioning.html#cb21-12"></a>spe.topo &lt;-<span class="st"> </span><span class="kw">rda</span>(spe.hel <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> envtopo)</span>
<span id="cb21-13"><a href="variation-partitioning.html#cb21-13"></a>R2a.all.topo &lt;-<span class="st"> </span><span class="kw">RsquareAdj</span>(spe.topo)<span class="op">$</span>adj.r.squared</span>
<span id="cb21-14"><a href="variation-partitioning.html#cb21-14"></a><span class="kw">ordiR2step</span>(<span class="kw">rda</span>(spe.hel <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> envtopo), <span class="dt">scope =</span> <span class="kw">formula</span>(spe.topo), </span>
<span id="cb21-15"><a href="variation-partitioning.html#cb21-15"></a>    <span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="dt">R2scope =</span> <span class="ot">TRUE</span>, <span class="dt">pstep =</span> <span class="dv">1000</span>)</span>
<span id="cb21-16"><a href="variation-partitioning.html#cb21-16"></a><span class="kw">names</span>(envtopo)</span>
<span id="cb21-17"><a href="variation-partitioning.html#cb21-17"></a>envtopo.pars &lt;-<span class="st"> </span>envtopo[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb21-18"><a href="variation-partitioning.html#cb21-18"></a></span>
<span id="cb21-19"><a href="variation-partitioning.html#cb21-19"></a><span class="co"># Varpart</span></span>
<span id="cb21-20"><a href="variation-partitioning.html#cb21-20"></a>spe.part &lt;-<span class="st"> </span><span class="kw">varpart</span>(spe.hel, envchem.pars, envtopo.pars)</span>
<span id="cb21-21"><a href="variation-partitioning.html#cb21-21"></a><span class="kw">windows</span>(<span class="dt">title =</span> <span class="st">&quot;Variation partitioning - parsimonious subsets&quot;</span>)</span>
<span id="cb21-22"><a href="variation-partitioning.html#cb21-22"></a><span class="kw">plot</span>(spe.part, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb21-23"><a href="variation-partitioning.html#cb21-23"></a></span>
<span id="cb21-24"><a href="variation-partitioning.html#cb21-24"></a><span class="co"># Tests of significance</span></span>
<span id="cb21-25"><a href="variation-partitioning.html#cb21-25"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(spe.hel, envchem.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fractions [a+b]</span></span>
<span id="cb21-26"><a href="variation-partitioning.html#cb21-26"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(spe.hel, envtopo.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fractions [b+c]</span></span>
<span id="cb21-27"><a href="variation-partitioning.html#cb21-27"></a>env.pars &lt;-<span class="st"> </span><span class="kw">cbind</span>(envchem.pars, envtopo.pars)</span>
<span id="cb21-28"><a href="variation-partitioning.html#cb21-28"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(spe.hel, env.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fractions [a+b+c]</span></span>
<span id="cb21-29"><a href="variation-partitioning.html#cb21-29"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(spe.hel, envchem.pars, envtopo.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fraction [a]</span></span>
<span id="cb21-30"><a href="variation-partitioning.html#cb21-30"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(spe.hel, envtopo.pars, envchem.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fraction [c]</span></span></code></pre></div>
<p>Now, the chemical variables explain 25.30% of the fish species
composition, the physiographic variables explain 14.20% of the fish
species composition and the interaction of these two types of variables
explained 19.60% of the fish species composition. All these fractions
are significant (p&lt;0.001).</p>
<p><strong>Challenge 3</strong>: Perform variation partitioning of the mite species
abundances with a first dataset for the significant substrate variables
(SubsDens, WaterCont and Substrate) and a second dataset for the
significant other variables (Shrud and Topo). What proportion of the
variation are explained by each dataset? What are the significant
fractions ?</p>
<p><strong>Challenge 3</strong>: Solution</p>
<p>This is what your code may look like:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="variation-partitioning.html#cb22-1"></a><span class="kw">str</span>(mite.env)</span>
<span id="cb22-2"><a href="variation-partitioning.html#cb22-2"></a>(<span class="dt">mite.subs =</span> mite.env[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)])  <span class="co">#First set of variables outlined in challenge </span></span>
<span id="cb22-3"><a href="variation-partitioning.html#cb22-3"></a>(<span class="dt">mite.other =</span> mite.env[, <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>)])  <span class="co">#Second set of variables outlined in challenge </span></span>
<span id="cb22-4"><a href="variation-partitioning.html#cb22-4"></a></span>
<span id="cb22-5"><a href="variation-partitioning.html#cb22-5"></a><span class="co"># RDA for mite.subs</span></span>
<span id="cb22-6"><a href="variation-partitioning.html#cb22-6"></a>rda.mite.subs &lt;-<span class="st"> </span><span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> mite.subs)</span>
<span id="cb22-7"><a href="variation-partitioning.html#cb22-7"></a>R2a.all.subs &lt;-<span class="st"> </span><span class="kw">RsquareAdj</span>(rda.mite.subs)<span class="op">$</span>adj.r.squared</span>
<span id="cb22-8"><a href="variation-partitioning.html#cb22-8"></a></span>
<span id="cb22-9"><a href="variation-partitioning.html#cb22-9"></a><span class="co"># Forward selection for mite.subs</span></span>
<span id="cb22-10"><a href="variation-partitioning.html#cb22-10"></a><span class="kw">ordiR2step</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> mite.subs), <span class="dt">scope =</span> <span class="kw">formula</span>(rda.mite.subs), </span>
<span id="cb22-11"><a href="variation-partitioning.html#cb22-11"></a>    <span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="dt">R2scope =</span> <span class="ot">TRUE</span>, <span class="dt">pstep =</span> <span class="dv">1000</span>)</span>
<span id="cb22-12"><a href="variation-partitioning.html#cb22-12"></a><span class="kw">names</span>(mite.subs)</span>
<span id="cb22-13"><a href="variation-partitioning.html#cb22-13"></a>(mite.subs.pars &lt;-<span class="st"> </span>mite.subs[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)])</span>
<span id="cb22-14"><a href="variation-partitioning.html#cb22-14"></a></span>
<span id="cb22-15"><a href="variation-partitioning.html#cb22-15"></a><span class="co"># RDA for mite.other</span></span>
<span id="cb22-16"><a href="variation-partitioning.html#cb22-16"></a>rda.mite.other &lt;-<span class="st"> </span><span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> mite.other)</span>
<span id="cb22-17"><a href="variation-partitioning.html#cb22-17"></a>R2a.all.other &lt;-<span class="st"> </span><span class="kw">RsquareAdj</span>(rda.mite.other)<span class="op">$</span>adj.r.squared</span>
<span id="cb22-18"><a href="variation-partitioning.html#cb22-18"></a></span>
<span id="cb22-19"><a href="variation-partitioning.html#cb22-19"></a><span class="co"># Forward selection for mite.other</span></span>
<span id="cb22-20"><a href="variation-partitioning.html#cb22-20"></a><span class="kw">ordiR2step</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> mite.other), <span class="dt">scope =</span> <span class="kw">formula</span>(rda.mite.other), </span>
<span id="cb22-21"><a href="variation-partitioning.html#cb22-21"></a>    <span class="dt">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="dt">R2scope =</span> <span class="ot">TRUE</span>, <span class="dt">pstep =</span> <span class="dv">1000</span>)</span>
<span id="cb22-22"><a href="variation-partitioning.html#cb22-22"></a><span class="kw">names</span>(mite.other)</span>
<span id="cb22-23"><a href="variation-partitioning.html#cb22-23"></a>(mite.other.pars &lt;-<span class="st"> </span>mite.other[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)])</span>
<span id="cb22-24"><a href="variation-partitioning.html#cb22-24"></a></span>
<span id="cb22-25"><a href="variation-partitioning.html#cb22-25"></a><span class="co"># Variation partitioning</span></span>
<span id="cb22-26"><a href="variation-partitioning.html#cb22-26"></a>(mite.spe.part &lt;-<span class="st"> </span><span class="kw">varpart</span>(mite.spe.hel, <span class="op">~</span>WatrCont <span class="op">+</span><span class="st"> </span>Substrate, </span>
<span id="cb22-27"><a href="variation-partitioning.html#cb22-27"></a>    <span class="op">~</span>Shrub <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mite.env))</span>
<span id="cb22-28"><a href="variation-partitioning.html#cb22-28"></a><span class="kw">windows</span>(<span class="dt">title =</span> <span class="st">&quot;Variation partitioning - parsimonious subsets&quot;</span>)</span>
<span id="cb22-29"><a href="variation-partitioning.html#cb22-29"></a><span class="kw">plot</span>(mite.spe.part, <span class="dt">digits =</span> <span class="dv">2</span>)</span>
<span id="cb22-30"><a href="variation-partitioning.html#cb22-30"></a></span>
<span id="cb22-31"><a href="variation-partitioning.html#cb22-31"></a><span class="co"># Tests of all testable fractions</span></span>
<span id="cb22-32"><a href="variation-partitioning.html#cb22-32"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Substrate, <span class="dt">data =</span> mite.env), </span>
<span id="cb22-33"><a href="variation-partitioning.html#cb22-33"></a>    <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fractions [a+b]</span></span>
<span id="cb22-34"><a href="variation-partitioning.html#cb22-34"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>Shrub <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mite.env), </span>
<span id="cb22-35"><a href="variation-partitioning.html#cb22-35"></a>    <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fractions [b+c]</span></span>
<span id="cb22-36"><a href="variation-partitioning.html#cb22-36"></a>(env.pars &lt;-<span class="st"> </span><span class="kw">cbind</span>(mite.env[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)]))</span>
<span id="cb22-37"><a href="variation-partitioning.html#cb22-37"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Substrate <span class="op">+</span><span class="st"> </span>Shrub <span class="op">+</span><span class="st"> </span>Topo, </span>
<span id="cb22-38"><a href="variation-partitioning.html#cb22-38"></a>    <span class="dt">data =</span> env.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fractions [a+b+c]</span></span>
<span id="cb22-39"><a href="variation-partitioning.html#cb22-39"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Substrate <span class="op">+</span><span class="st"> </span><span class="kw">Condition</span>(Shrub <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-40"><a href="variation-partitioning.html#cb22-40"></a><span class="st">    </span>Topo), <span class="dt">data =</span> env.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fraction [a]</span></span>
<span id="cb22-41"><a href="variation-partitioning.html#cb22-41"></a><span class="kw">anova.cca</span>(<span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>Shrub <span class="op">+</span><span class="st"> </span>Topo <span class="op">+</span><span class="st"> </span><span class="kw">Condition</span>(WatrCont <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-42"><a href="variation-partitioning.html#cb22-42"></a><span class="st">    </span>Substrate), <span class="dt">data =</span> env.pars), <span class="dt">step =</span> <span class="dv">1000</span>)  <span class="co"># Test of fraction [c]</span></span></code></pre></div>
<p>In this case, substrate variables explain 14.00% of the mite species
composition, the other environmental variables explain 9.1% of the mite
species composition and the interaction of these two types of vriables
explained 16.90% of the mite species composition. All these fractions
are significant (p&lt;0.001).</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="partial-redundancy-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-regression-tree.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
