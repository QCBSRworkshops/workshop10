<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 9 Arbre de régression multivarié | Atelier 10: Analyses multivariées avancées en R</title>
  <meta name="description" content="Analyses multivariées avancées en R" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 9 Arbre de régression multivarié | Atelier 10: Analyses multivariées avancées en R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Analyses multivariées avancées en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop10" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 9 Arbre de régression multivarié | Atelier 10: Analyses multivariées avancées en R" />
  
  <meta name="twitter:description" content="Analyses multivariées avancées en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="partitionnement-de-la-variation.html"/>
<link rel="next" href="analyse-discriminante-linéaire.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Analyses multivariées avancées dans <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="why-advanced-multivariate-methods.html"><a href="why-advanced-multivariate-methods.html"><i class="fa fa-check"></i><b>3</b> Why “advanced multivariate methods”?</a></li>
<li class="chapter" data-level="4" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i><b>4</b> Exploration les données</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploration.html"><a href="exploration.html#données-dabondances-despèces"><i class="fa fa-check"></i><b>4.1</b> Données d’abondances d’espèces</a></li>
<li class="chapter" data-level="4.2" data-path="exploration.html"><a href="exploration.html#données-environnementales"><i class="fa fa-check"></i><b>4.2</b> Données environnementales</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="exploration.html"><a href="exploration.html#colinéarité"><i class="fa fa-check"></i><b>4.2.1</b> Colinéarité</a></li>
<li class="chapter" data-level="4.2.2" data-path="exploration.html"><a href="exploration.html#standardisation-des-données"><i class="fa fa-check"></i><b>4.2.2</b> Standardisation des données</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Constrained ordinations</b></span></li>
<li class="chapter" data-level="5" data-path="que-sont-les-ordinations-contraintes.html"><a href="que-sont-les-ordinations-contraintes.html"><i class="fa fa-check"></i><b>5</b> Que sont les ordinations “contraintes” ?</a></li>
<li class="chapter" data-level="6" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html"><i class="fa fa-check"></i><b>6</b> Analyse canonique de redondances</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#computation"><i class="fa fa-check"></i><b>6.1</b> Computation</a></li>
<li class="chapter" data-level="6.2" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#implémentation-dans-r"><i class="fa fa-check"></i><b>6.2</b> Implémentation dans R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#sélection-de-variables"><i class="fa fa-check"></i><b>6.2.1</b> Sélection de variables</a></li>
<li class="chapter" data-level="6.2.2" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#tester-la-significativité"><i class="fa fa-check"></i><b>6.2.2</b> Tester la significativité</a></li>
<li class="chapter" data-level="6.2.3" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#représentation-graphique-des-rdas"><i class="fa fa-check"></i><b>6.2.3</b> Représentation graphique des RDAs</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#défi-1"><i class="fa fa-check"></i><b>6.3</b> Défi 1</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#défi-1-solution"><i class="fa fa-check"></i><b>6.3.1</b> Défi 1: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rda-partielle.html"><a href="rda-partielle.html"><i class="fa fa-check"></i><b>7</b> RDA partielle</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rda-partielle.html"><a href="rda-partielle.html#exemple-rda-partielle-sur-les-données-doubs"><i class="fa fa-check"></i><b>7.1</b> Exemple: RDA partielle sur les données Doubs</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="rda-partielle.html"><a href="rda-partielle.html#interprétation-de-la-sortie-dune-rda-partielle"><i class="fa fa-check"></i><b>7.1.1</b> Interprétation de la sortie d’une RDA partielle</a></li>
<li class="chapter" data-level="7.1.2" data-path="rda-partielle.html"><a href="rda-partielle.html#tester-la-significativité-1"><i class="fa fa-check"></i><b>7.1.2</b> Tester la significativité</a></li>
<li class="chapter" data-level="7.1.3" data-path="rda-partielle.html"><a href="rda-partielle.html#représentation-graphique"><i class="fa fa-check"></i><b>7.1.3</b> Représentation graphique</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="rda-partielle.html"><a href="rda-partielle.html#défi-2"><i class="fa fa-check"></i><b>7.2</b> Défi 2</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="rda-partielle.html"><a href="rda-partielle.html#défi-2-solution"><i class="fa fa-check"></i><b>7.2.1</b> Défi 2: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html"><i class="fa fa-check"></i><b>8</b> Partitionnement de la variation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#partitionnement-de-la-variation-dans-r"><i class="fa fa-check"></i><b>8.1</b> Partitionnement de la variation dans R</a></li>
<li class="chapter" data-level="8.2" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#tester-la-significativité-2"><i class="fa fa-check"></i><b>8.2</b> Tester la significativité</a></li>
<li class="chapter" data-level="8.3" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#défi-3"><i class="fa fa-check"></i><b>8.3</b> Défi 3</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#défi-3-solution"><i class="fa fa-check"></i><b>8.3.1</b> Défi 3: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html"><i class="fa fa-check"></i><b>9</b> Arbre de régression multivarié</a>
<ul>
<li class="chapter" data-level="9.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#computation-1"><i class="fa fa-check"></i><b>9.1</b> Computation</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#construction-de-larbre-partitionnement-des-données-sous-contrainte"><i class="fa fa-check"></i><b>9.1.1</b> Construction de l’arbre: Partitionnement des données sous contrainte</a></li>
<li class="chapter" data-level="9.1.2" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#sélection-de-larbre-validation-croisée-et-élagage-de-larbre"><i class="fa fa-check"></i><b>9.1.2</b> Sélection de l’arbre: Validation croisée et élagage de l’arbre</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#mrt-dans-r"><i class="fa fa-check"></i><b>9.2</b> MRT dans R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#processus-de-sélection"><i class="fa fa-check"></i><b>9.2.1</b> Processus de sélection</a></li>
<li class="chapter" data-level="9.2.2" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#interprétation-des-résultats"><i class="fa fa-check"></i><b>9.2.2</b> Interprétation des résultats</a></li>
<li class="chapter" data-level="9.2.3" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#indicator-species"><i class="fa fa-check"></i><b>9.2.3</b> Indicator species</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#défi-4"><i class="fa fa-check"></i><b>9.3</b> Défi 4</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#challenge-4-solution"><i class="fa fa-check"></i><b>9.3.1</b> Challenge 4: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html"><i class="fa fa-check"></i><b>10</b> Analyse discriminante linéaire</a>
<ul>
<li class="chapter" data-level="10.1" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#lda-dans-r-rivière-doubs"><i class="fa fa-check"></i><b>10.1</b> LDA dans R: Rivière Doubs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#créer-des-groupes-a-priori"><i class="fa fa-check"></i><b>10.1.1</b> Créer des groupes <em>a priori</em></a></li>
<li class="chapter" data-level="10.1.2" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#lda-dans-r"><i class="fa fa-check"></i><b>10.1.2</b> LDA dans R</a></li>
<li class="chapter" data-level="10.1.3" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#exactitude-du-groupement"><i class="fa fa-check"></i><b>10.1.3</b> Exactitude du groupement</a></li>
<li class="chapter" data-level="10.1.4" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#prédictions"><i class="fa fa-check"></i><b>10.1.4</b> Prédictions</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#défi-5"><i class="fa fa-check"></i><b>10.2</b> Défi 5</a></li>
</ul></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="11" data-path="résumé.html"><a href="résumé.html"><i class="fa fa-check"></i><b>11</b> Résumé</a></li>
<li class="chapter" data-level="12" data-path="ressources-additionelles.html"><a href="ressources-additionelles.html"><i class="fa fa-check"></i><b>12</b> Ressources additionelles</a></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 10: Analyses multivariées avancées en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="arbre-de-régression-multivarié" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapitre 9</span> Arbre de régression multivarié<a href="arbre-de-régression-multivarié.html#arbre-de-régression-multivarié" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>L’arbre de régression multivarié (MRT) est une <strong>technique de groupement hiérarchique</strong>. Introduit par <span class="citation">De’ath (<a href="#ref-de2002multivariate" role="doc-biblioref">2002</a>)</span>, le MRT divise une matrice de réponse (<span class="math inline">\(Y\)</span>) en groupes en fonction de seuils de variables explicatives (<span class="math inline">\(X\)</span>). Comme la RDA, la MRT est une technique de régression. Alors que la première explique la structure globale des relations par un modèle linéaire, la seconde produit un modèle en arbre pour mettre en évidence les structures locales et les interactions entre les variables.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-72"></span>
<img src="images/MRT.png" alt="The basic structure of a multivariate regression tree (MRT)." width="70%" />
<p class="caption">
Figure 9.1: The basic structure of a multivariate regression tree (MRT).
</p>
</div>
<p>L’arbre de régression multivarié a plusieurs charéctéristiques avantageux:</p>
<ul>
<li>Les résultats sont faciles à visualiser et à interpréter (c’est un arbre !) ;</li>
<li>Il identifie clairement l’importance des variables explicatives ;</li>
<li>Il est robuste aux valeurs manquantes ;</li>
<li>Il est robuste à la colinéarité entre les variables explicatives ;</li>
<li>Il peut traiter des variables explicatives brutes, alors il n’est pas nécessaire de les standardiser.</li>
</ul>
<div class="explanation">
<p>Une petite note sur le vocabulaire lié aux MRTs:</p>
<ul>
<li><strong>Branches</strong>: Chaque lignée formée par un noeud;</li>
<li><strong>Noeuds</strong>: Point où les données se divisent en 2 groupes (caractérisé par une valeur seuil d’une variable explicative);<br />
</li>
<li><strong>Feuilles</strong>: Groupe terminal de sites.<br />
</li>
</ul>
</div>
<div id="computation-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Computation<a href="arbre-de-régression-multivarié.html#computation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le MRT divise les données en groupes ayant des compositions en espèce
semblables et caractérisés par des variables environnementales. La
méthode implique deux volets s’effectuant en parallèle: <strong>1)</strong> la
construction de l’arbre et <strong>2)</strong> la sélection de la partition finale
optimale par validation croisée.
The MRT splits the data into clusters of samples similar in their species composition based on environmental value thresholds. It involves two procedures running at the same time: <strong>1)</strong> the computation of the constrained partitioning of the data, and <strong>2)</strong> the calculation of the relative error of the successive partitioning levels by multiple cross-validations. Cette validation croisée vise, en fait, à identifier le meilleur arbre prédictif. Le “<em>meilleur</em>” arbre varie en fonction des objectifs de votre étude. En général, on cherche un arbre qui est parcimonieux, mais qui possède un nombre de groupes informatif. Il s’agit, bien entendu, d’une décision subjective à prendre en fonction de la question à laquelle vous tentez de répondre.</p>
<div id="construction-de-larbre-partitionnement-des-données-sous-contrainte" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Construction de l’arbre: Partitionnement des données sous contrainte<a href="arbre-de-régression-multivarié.html#construction-de-larbre-partitionnement-des-données-sous-contrainte" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Premièrement, la méthode calcule toutes les partitions des sites en deux
groupes. Pour chaque variable environnementale quantitative, les sites
seront classés en ordre croissant des valeurs; pour chaque variable
qualitative (ou catégorique), les sites seront classés par niveaux. La
méthode divise les données après le premier objet, après le second, et
ainsi de suite et calcule à chaque fois la somme des carrés des écarts
intra-groupes de la matrice réponse. La méthode choisira la partition
qui minimisera la somme des carrés des écarts intra-groupes et le point
de division défini par une valeur seuil d’une variable
environnementale. Ces étapes seront répétées dans les deux groupes
formés précédemment, jusqu’à ce que tous les objets forment leur propre
groupe. En d’autre mots, jusqu’à ce que chaque feuille de l’arbre de
contienne qu’un seul objet.</p>
</div>
<div id="sélection-de-larbre-validation-croisée-et-élagage-de-larbre" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Sélection de l’arbre: Validation croisée et élagage de l’arbre<a href="arbre-de-régression-multivarié.html#sélection-de-larbre-validation-croisée-et-élagage-de-larbre" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction effectue également une validation croisée et identifie
l’arbre ayant le meilleur pouvoir prédictif. La validation croisée
s’effectue en utilisant une partie des données pour construire l’arbre
et le reste des données est classé dans les groupes créés. Dans un arbre
ayant un <em>bon pouvoir prédictif</em>, les objets sont assignés aux groupes
appropriés. L’<strong>erreur relative de validation croisée (ERVC ou CVRE)</strong>
mesure l’erreur de prédiction. Sans validation croisée, le nombre de
partitions retenu serait celui minimisant la variance non expliquée par
l’arbre (i.e. l’erreur relative: la somme des carrés des écarts
intra-groupes de toutes les feuilles divisée par la somme de carrée des
écarts de toutes les données). Cette solution maximise le <span class="math inline">\(R^2\)</span> et on
obtiendrait donc un arbre explicatif plutôt que prédictif.</p>
</div>
</div>
<div id="mrt-dans-r" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> MRT dans R<a href="arbre-de-régression-multivarié.html#mrt-dans-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La fonction <code>mvpart()</code> du paquet <code>mvpart</code> calcule à la fois la partition et les étapes de validation croisée requises pour construire un arbre de régression multivarié.</p>
<p>Nous allons démontrer le processus de construction d’un arbre de régression multivarié sur les données de la rivière Doubs.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="arbre-de-régression-multivarié.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enlever la variable “distance from source”</span></span>
<span id="cb96-2"><a href="arbre-de-régression-multivarié.html#cb96-2" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> <span class="fu">subset</span>(env, <span class="at">select =</span> <span class="sc">-</span>das)</span>
<span id="cb96-3"><a href="arbre-de-régression-multivarié.html#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="arbre-de-régression-multivarié.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Construire l&#39;arbre de regression multivarié</span></span>
<span id="cb96-5"><a href="arbre-de-régression-multivarié.html#cb96-5" aria-hidden="true" tabindex="-1"></a>doubs.mrt <span class="ot">&lt;-</span> <span class="fu">mvpart</span>(<span class="fu">as.matrix</span>(spe.hel) <span class="sc">~</span> ., <span class="at">data =</span> env,</span>
<span id="cb96-6"><a href="arbre-de-régression-multivarié.html#cb96-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xv =</span> <span class="st">&quot;pick&quot;</span>, <span class="co"># selection graphique intéractive</span></span>
<span id="cb96-7"><a href="arbre-de-régression-multivarié.html#cb96-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xval =</span> <span class="fu">nrow</span>(spe.hel), <span class="co"># nombre de validations</span></span>
<span id="cb96-8"><a href="arbre-de-régression-multivarié.html#cb96-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xvmult =</span> <span class="dv">100</span>, <span class="co"># nombre de validations multiples</span></span>
<span id="cb96-9"><a href="arbre-de-régression-multivarié.html#cb96-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">which =</span> <span class="dv">4</span>, <span class="co"># identifier les noeuds</span></span>
<span id="cb96-10"><a href="arbre-de-régression-multivarié.html#cb96-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">margin =</span> <span class="fl">0.01</span>, <span class="at">cp =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## X-Val rep : 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99  100
## Minimum tree sizes
## tabmins
##  2  4  5  6  7  8  9 10 
## 11  2  1 12 11 28  4 31</code></pre>
<p><img src="book-fr_files/figure-html/unnamed-chunk-74-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>À ce stade, vous devrez sélectionner l’arbre avec un nombre <em>approprié</em> de groupes, en fonction de l’objectif de votre étude. En d’autres mots, vous devez élaguer l’arbre en choisissant l’arbre le plus approprié. Un arbre entièrement résolu n’est pas le résultat souhaitable ; au contraire, on s’intéresse généralement à un arbre comprenant uniquement des partitions/groupes informatifs. Dans ce cas, il est possible d’avoir une idée <em>a priori</em> du nombre de groupes potentiels à retenir. Vous pouvez faire ce choix de manière interactive, avec l’argument <code>xv = "pick"</code>.</p>
<p>Le graphique montre l’erreur relative (RE, en vert) et l’erreur
relative de validation croisée (en bleu) d’arbres de tailles
croissantes. Le point rouge indique la solution avec la valeur minimale
de CVRE et le point orange montre l’arbre le plus petit dont la valeur
de CVRE est à 1 écart type de de la valeur CVRE minimale. <span class="citation">Breiman et al. (<a href="#ref-breiman1984classification" role="doc-biblioref">1984</a>)</span> suggèrent de choisir cette dernière option car cet arbre a à la
fois une erreur relative de validation croisée près de la plus faible et
il contient un nombre restreint de groupe, ce qui en fait un choix
parcimonieux. Les barres vertes en haut du graphique indiquent le nombre
de fois que chaque taille d’arbre a été choisi durant le processus de
validation croisée. Ce graphique est interactif. Il faudra donc cliquer sur le point bleu
correspondant à la taille de l’arbre choisie. En résumé:</p>
<ul>
<li>Points verts: Erreur relative</li>
<li>Points bleus: Erreur relative de validation croisée (CVRE)</li>
<li>Point rouge: Arbre avec la valeur minimale de CVRE</li>
<li>Point orange: l’arbre le plus petit ayant un CVRE à 1 écart type du CVRE minimal</li>
<li>Barres vertes: # de fois que chaque taille d’arbre a été choisi</li>
</ul>
<p>Nous n’avons pas de prédiction <em>a priori</em> sur la façon de diviser ces données, donc nous allons sélectionner le plus petit arbre à moins d’une erreur standard de l’arbre qui est le mieux ajusté (c’est-à-dire, le point orange). Nous pouvons sélectionner cet arbre en utilisant l’argument <code>xv = "1se"</code>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="arbre-de-régression-multivarié.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Faire le choix d&#39;arbre (point orange)</span></span>
<span id="cb98-2"><a href="arbre-de-régression-multivarié.html#cb98-2" aria-hidden="true" tabindex="-1"></a>doubs.mrt <span class="ot">&lt;-</span> <span class="fu">mvpart</span>(<span class="fu">as.matrix</span>(spe.hel) <span class="sc">~</span> ., <span class="at">data =</span> env,</span>
<span id="cb98-3"><a href="arbre-de-régression-multivarié.html#cb98-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xv =</span> <span class="st">&quot;1se&quot;</span>, <span class="co"># select smallest tree within 1 se</span></span>
<span id="cb98-4"><a href="arbre-de-régression-multivarié.html#cb98-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xval =</span> <span class="fu">nrow</span>(spe.hel), <span class="co"># number of cross-validations</span></span>
<span id="cb98-5"><a href="arbre-de-régression-multivarié.html#cb98-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xvmult =</span> <span class="dv">100</span>, <span class="co"># number of multiple cross-validations</span></span>
<span id="cb98-6"><a href="arbre-de-régression-multivarié.html#cb98-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">which =</span> <span class="dv">4</span>, <span class="co"># plot both node labels</span></span>
<span id="cb98-7"><a href="arbre-de-régression-multivarié.html#cb98-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">margin =</span> <span class="fl">0.01</span>, <span class="at">cp =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## X-Val rep : 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99  100
## Minimum tree sizes
## tabmins
##  2  4  5  6  7  8  9 10 
##  9  1  2 10  9 26  5 38</code></pre>
<p><img src="book-fr_files/figure-html/unnamed-chunk-75-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Des statistiques sont affichées au bas de l’arbre: l’erreur résiduelle,
l’erreur de validation croisée et l’erreur type. Cet arbre n’est
constitué que de deux branches séparées par un noeud. Sous chaque feuille, on retrouve un petit diagramme à bandes montrant
les abondances des espèces des sites retrouvés dans la branche, le
nombre de sites et l’erreur relative. De cette figure, on peut rapporter les statistiques suivantes:
* La matrice des espèces est partitionnée en fonction d’un seuil d’altitude (361.5 m)<br />
* Erreur résiduelle = <strong>0.563</strong>, ce qui signifie que le R2 du modèle est <strong>43.7%</strong> (<span class="math inline">\(1 - 0.563 = 0.437\)</span>)</p>
<div id="processus-de-sélection" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Processus de sélection<a href="arbre-de-régression-multivarié.html#processus-de-sélection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On peut aussi comparer plusieurs solutions, pour nous aider à choisir le meilleur arbre. Par exemple, examinons une solution à dix groupes!</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="arbre-de-régression-multivarié.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution avec 10 groupes</span></span>
<span id="cb100-2"><a href="arbre-de-régression-multivarié.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mvpart</span>(<span class="fu">as.matrix</span>(spe.hel) <span class="sc">~</span> ., <span class="at">data =</span> env,</span>
<span id="cb100-3"><a href="arbre-de-régression-multivarié.html#cb100-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xv =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># aucune validation croisée</span></span>
<span id="cb100-4"><a href="arbre-de-régression-multivarié.html#cb100-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">10</span>, <span class="co"># fixer la taille de l&#39;arbre</span></span>
<span id="cb100-5"><a href="arbre-de-régression-multivarié.html#cb100-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">which =</span> <span class="dv">4</span>,</span>
<span id="cb100-6"><a href="arbre-de-régression-multivarié.html#cb100-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">margin =</span> <span class="fl">0.01</span>, <span class="at">cp =</span> <span class="dv">0</span>, <span class="at">prn =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-76-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Cet arbre est beaucoup plus difficile à interpréter, car il y a beaucoup de groupes ! Bien que cette version de l’arbre offre un pouvoir explicatif plus élevé, son pouvoir <em>prédictif</em> (erreur CV = 0.671) est sensiblement le même que celui de la solution précédente à deux groupes (erreur CV = 0.673). Ceci suggère que nous pourrions essayer un arbre avec un peu plus de groupements que la solution à deux groupes, tout en restant en dessous de dix groupes.</p>
<p>Voyons une solution avec moins de groupes (4 groupes)!</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="arbre-de-régression-multivarié.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution avec 4 groupes seulement</span></span>
<span id="cb101-2"><a href="arbre-de-régression-multivarié.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mvpart</span>(<span class="fu">as.matrix</span>(spe.hel) <span class="sc">~</span> ., <span class="at">data =</span> env,</span>
<span id="cb101-3"><a href="arbre-de-régression-multivarié.html#cb101-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xv =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># aucune validation croisée</span></span>
<span id="cb101-4"><a href="arbre-de-régression-multivarié.html#cb101-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">4</span>, <span class="co"># fixer la taille de l&#39;arbre</span></span>
<span id="cb101-5"><a href="arbre-de-régression-multivarié.html#cb101-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">which =</span> <span class="dv">4</span>,</span>
<span id="cb101-6"><a href="arbre-de-régression-multivarié.html#cb101-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">margin =</span> <span class="fl">0.01</span>, <span class="at">cp =</span> <span class="dv">0</span>, <span class="at">prn =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Cet arbre est beaucoup plus facile à interpréter! Il offre également un pouvoir explicatif plus élevé (erreur plus faible) que notre solution originale, et un pouvoir prédictif plus élevé que les deux solutions précédentes (erreur CV). Nous avons un champion!</p>
</div>
<div id="interprétation-des-résultats" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Interprétation des résultats<a href="arbre-de-régression-multivarié.html#interprétation-des-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour savoir combien de variance est expliquée par chaque nœud de l’arbre, nous devons consulter le paramètre de complexité (CP). Le CP à <code>nsplit = 0</code> est le <span class="math inline">\(R^2\)</span> de l’arbre complet.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="arbre-de-régression-multivarié.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier le paramètre de compléxité</span></span>
<span id="cb102-2"><a href="arbre-de-régression-multivarié.html#cb102-2" aria-hidden="true" tabindex="-1"></a>doubs.mrt<span class="sc">$</span>cptable</span></code></pre></div>
<pre><code>##          CP nsplit rel error   xerror       xstd
## 1 0.4369561      0 1.0000000 1.073973 0.07490428
## 2 0.1044982      1 0.5630439 0.676255 0.09508638</code></pre>
<p>Le résumé présente ensuite, pour chaque nœud, les meilleures valeurs de seuil pour le groupement des données.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="arbre-de-régression-multivarié.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(doubs.mrt)</span></code></pre></div>
<pre><code>## Call:
## mvpart(form = as.matrix(spe.hel) ~ ., data = env, xv = &quot;1se&quot;, 
##     xval = nrow(spe.hel), xvmult = 100, margin = 0.01, which = 4, 
##     legend = FALSE, cp = 0)
##   n= 29 
## 
##          CP nsplit rel error   xerror       xstd
## 1 0.4369561      0 1.0000000 1.073973 0.07490428
## 2 0.1044982      1 0.5630439 0.676255 0.09508638
## 
## Node number 1: 29 observations,    complexity param=0.4369561
##   Means=0.07299,0.2472,0.2581,0.2721,0.07133,0.06813,0.06897,0.07664,0.1488,0.2331,0.113,0.07879,0.1724,0.1366,0.1103,0.08216,0.08751,0.07113,0.07312,0.1345,0.06307,0.04423,0.1015,0.1862,0.07713,0.1623,0.07283, Summed MSE=0.4851823 
##   left son=2 (15 obs) right son=3 (14 obs)
##   Primary splits:
##       alt &lt; 361.5 to the right, improve=0.4369561, (0 missing)
##       deb &lt; 23.65 to the left,  improve=0.4369561, (0 missing)
##       amm &lt; 0.06  to the left,  improve=0.3529830, (0 missing)
##       nit &lt; 1.415 to the left,  improve=0.3513335, (0 missing)
##       pen &lt; 1.5   to the right, improve=0.3372429, (0 missing)
## 
## Node number 2: 15 observations
##   Means=0.1208,0.4463,0.4194,0.4035,0.1104,0.09023,0,0.02108,0.1256,0.2164,0.04392,0.01054,0.107,0.09779,0.06853,0,0.01054,0.01617,0.01054,0.09489,0,0,0,0.08629,0,0,0, Summed MSE=0.3194207 
## 
## Node number 3: 14 observations
##   Means=0.02179,0.03391,0.08514,0.1313,0.02945,0.04444,0.1429,0.1362,0.1736,0.2509,0.1871,0.1519,0.2425,0.1781,0.1551,0.1702,0.17,0.13,0.1402,0.177,0.1306,0.09163,0.2103,0.2932,0.1598,0.3362,0.1509, Summed MSE=0.2236343</code></pre>
</div>
<div id="indicator-species" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Indicator species<a href="arbre-de-régression-multivarié.html#indicator-species" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On pourrait aussi identifier les espèces indicatrices importantes pour chaque groupe de sites.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="arbre-de-régression-multivarié.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul d&#39;une valeur indval pour chaque espèce</span></span>
<span id="cb106-2"><a href="arbre-de-régression-multivarié.html#cb106-2" aria-hidden="true" tabindex="-1"></a>doubs.mrt.indval <span class="ot">&lt;-</span> <span class="fu">indval</span>(spe.hel, doubs.mrt<span class="sc">$</span>where)</span>
<span id="cb106-3"><a href="arbre-de-régression-multivarié.html#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="arbre-de-régression-multivarié.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les espèces indicatrices à chaque noeud</span></span>
<span id="cb106-5"><a href="arbre-de-régression-multivarié.html#cb106-5" aria-hidden="true" tabindex="-1"></a>doubs.mrt.indval<span class="sc">$</span>maxcls[<span class="fu">which</span>(doubs.mrt.indval<span class="sc">$</span>pval <span class="sc">&lt;=</span> <span class="fl">0.05</span>)]</span></code></pre></div>
<pre><code>## TRU VAI LOC HOT TOX BAR SPI GOU BRO PER BOU PSO ROT CAR TAN BCO PCH GRE GAR BBO 
##   1   1   1   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2 
## ABL ANG 
##   2   2</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="arbre-de-régression-multivarié.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire leur valeur indval</span></span>
<span id="cb108-2"><a href="arbre-de-régression-multivarié.html#cb108-2" aria-hidden="true" tabindex="-1"></a>doubs.mrt.indval<span class="sc">$</span>indcls[<span class="fu">which</span>(doubs.mrt.indval<span class="sc">$</span>pval <span class="sc">&lt;=</span> <span class="fl">0.05</span>)]</span></code></pre></div>
<pre><code>##       TRU       VAI       LOC       HOT       TOX       BAR       SPI       GOU 
## 0.8674301 0.7758443 0.7042392 0.8571429 0.6185282 0.6363569 0.7347359 0.6442950 
##       BRO       PER       BOU       PSO       ROT       CAR       TAN       BCO 
## 0.5533235 0.5449488 0.7857143 0.8070918 0.6352865 0.7307582 0.5115135 0.6428571 
##       PCH       GRE       GAR       BBO       ABL       ANG 
## 0.5000000 0.8571429 0.7726181 0.7142857 1.0000000 0.7857143</code></pre>
<p>TRU a la valeur indicatrice la plus élevée (0.867) dans l’ensemble, et est une espèce indicatrice pour la première feuille (alt &gt;= 361.5) de l’arbre.</p>
</div>
</div>
<div id="défi-4" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Défi 4<a href="arbre-de-régression-multivarié.html#défi-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Créez un arbre de régression multivarié pour les données <code>mite</code>.
* Choisir l’arbre le plus petit à 1 écart type du CVRE minimal.
* Quelle est la variance totale expliquée par cet arbre?
* Combien y a-t-il de feuilles?
* Quels sont les 3 principales espèces discriminantes?</p>
<p>Rappel: chargez les données!</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="arbre-de-régression-multivarié.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mite&quot;</span>)</span>
<span id="cb110-2"><a href="arbre-de-régression-multivarié.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mite.env&quot;</span>)</span></code></pre></div>
<p>Rappel de fonctions utiles:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="arbre-de-régression-multivarié.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">?</span><span class="st">`</span>(<span class="fu">mvpart</span>()  <span class="co"># argument &#39;xv&#39;!</span></span>
<span id="cb111-2"><a href="arbre-de-régression-multivarié.html#cb111-2" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-3"><a href="arbre-de-régression-multivarié.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>()</span></code></pre></div>
<div id="challenge-4-solution" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Challenge 4: Solution<a href="arbre-de-régression-multivarié.html#challenge-4-solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Étape 1:</strong> Créer un arbre de régression multivarié.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="arbre-de-régression-multivarié.html#cb112-1" aria-hidden="true" tabindex="-1"></a>mite.mrt <span class="ot">&lt;-</span> <span class="fu">mvpart</span>(<span class="fu">as.matrix</span>(mite.spe.hel) <span class="sc">~</span> ., <span class="at">data =</span> mite.env,</span>
<span id="cb112-2"><a href="arbre-de-régression-multivarié.html#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xv =</span> <span class="st">&quot;1se&quot;</span>, <span class="at">xval =</span> <span class="fu">nrow</span>(mite.spe.hel), <span class="at">xvmult =</span> <span class="dv">100</span>, <span class="at">which =</span> <span class="dv">4</span>,</span>
<span id="cb112-3"><a href="arbre-de-régression-multivarié.html#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">margin =</span> <span class="fl">0.01</span>, <span class="at">cp =</span> <span class="dv">0</span>, <span class="at">prn =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-85-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Quelle est la variance totale expliquée (<span class="math inline">\(R^2\)</span>) par cet arbre?
* <span class="math inline">\(1 - 0.748 = 0.252\)</span>, alors l’arbre explique <strong>25.2%</strong> de la variation dans la matrice d’abondances.</p>
<p>Combien y a-t-il de feuilles?
* 2 feuilles</p>
<p><strong>Étape 2</strong>: Identifier les espèces indicatrices.</p>
<p>Quelles sont les espèces indicatrices pour chaque groupe de sites?</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="arbre-de-régression-multivarié.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul d&#39;une valeur indicatrice pour chaque espèce</span></span>
<span id="cb113-2"><a href="arbre-de-régression-multivarié.html#cb113-2" aria-hidden="true" tabindex="-1"></a>mite.mrt.indval <span class="ot">&lt;-</span> <span class="fu">indval</span>(mite.spe.hel, mite.mrt<span class="sc">$</span>where)</span>
<span id="cb113-3"><a href="arbre-de-régression-multivarié.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="arbre-de-régression-multivarié.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les espèces indicatrices à chaque noeud</span></span>
<span id="cb113-5"><a href="arbre-de-régression-multivarié.html#cb113-5" aria-hidden="true" tabindex="-1"></a>mite.mrt.indval<span class="sc">$</span>maxcls[<span class="fu">which</span>(mite.mrt.indval<span class="sc">$</span>pval <span class="sc">&lt;=</span> <span class="fl">0.05</span>)]</span></code></pre></div>
<pre><code>##     PHTH     RARD     SSTR  Protopl     MEGR     MPRO     TVIE     HMIN 
##        2        2        2        2        2        2        1        2 
##    HMIN2     NPRA     TVEL     ONOV     SUCT     LCIL Oribatl1 Ceratoz1 
##        2        2        2        2        2        1        2        1 
## Galumna1 Stgncrs2 Trhypch1     NCOR     SLAT     FSET Lepidzts Miniglmn 
##        2        2        1        1        2        2        2        2 
##     LRUG Ceratoz3 Trimalc2 
##        1        1        1</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="arbre-de-régression-multivarié.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire leur valeur indval</span></span>
<span id="cb115-2"><a href="arbre-de-régression-multivarié.html#cb115-2" aria-hidden="true" tabindex="-1"></a>mite.mrt.indval<span class="sc">$</span>indcls[<span class="fu">which</span>(mite.mrt.indval<span class="sc">$</span>pval <span class="sc">&lt;=</span> <span class="fl">0.05</span>)]</span></code></pre></div>
<pre><code>##      PHTH      RARD      SSTR   Protopl      MEGR      MPRO      TVIE      HMIN 
## 0.5317919 0.5584677 0.2256592 0.2517509 0.5769554 0.1567789 0.3793303 0.6421174 
##     HMIN2      NPRA      TVEL      ONOV      SUCT      LCIL  Oribatl1  Ceratoz1 
## 0.6193076 0.4620892 0.7412296 0.6312483 0.6087557 0.7152107 0.5978167 0.4744997 
##  Galumna1  Stgncrs2  Trhypch1      NCOR      SLAT      FSET  Lepidzts  Miniglmn 
## 0.5974145 0.3897917 0.4545803 0.4539642 0.2249109 0.6361272 0.2108305 0.1880194 
##      LRUG  Ceratoz3  Trimalc2 
## 0.6683300 0.3962540 0.4358974</code></pre>

</div>
</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-breiman1984classification" class="csl-entry">
Breiman, Leo, Jerome Friedman, Charles J Stone, and Richard A Olshen. 1984. <em>Classification and Regression Trees</em>. CRC press.
</div>
<div id="ref-de2002multivariate" class="csl-entry">
De’ath, Glenn. 2002. <span>“Multivariate Regression Trees: A New Technique for Modeling Species–Environment Relationships.”</span> <em>Ecology</em> 83 (4): 1105–17.
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="partitionnement-de-la-variation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyse-discriminante-linéaire.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
