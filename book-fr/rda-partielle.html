<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 7 RDA partielle | Atelier 10: Analyses multivariées avancées en R</title>
  <meta name="description" content="Analyses multivariées avancées en R" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 7 RDA partielle | Atelier 10: Analyses multivariées avancées en R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Analyses multivariées avancées en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop10" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 7 RDA partielle | Atelier 10: Analyses multivariées avancées en R" />
  
  <meta name="twitter:description" content="Analyses multivariées avancées en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="analyse-canonique-de-redondances.html"/>
<link rel="next" href="partitionnement-de-la-variation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ<span></span></b></span></li>
<li><a href="index.html#préface">Préface<span></span></a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>0.1</b> Code de conduite<span></span></a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu<span></span></a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices<span></span></a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!<span></span></a></li>
</ul></li>
<li class="part"><span><b>Analyses multivariées avancées dans <code>R</code><span></span></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage<span></span></a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier<span></span></a></li>
<li class="chapter" data-level="3" data-path="why-advanced-multivariate-methods.html"><a href="why-advanced-multivariate-methods.html"><i class="fa fa-check"></i><b>3</b> Why “advanced multivariate methods”?<span></span></a></li>
<li class="chapter" data-level="4" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i><b>4</b> Exploration les données<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="exploration.html"><a href="exploration.html#données-dabondances-despèces"><i class="fa fa-check"></i><b>4.1</b> Données d’abondances d’espèces<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="exploration.html"><a href="exploration.html#données-environnementales"><i class="fa fa-check"></i><b>4.2</b> Données environnementales<span></span></a><ul>
<li class="chapter" data-level="4.2.1" data-path="exploration.html"><a href="exploration.html#colinéarité"><i class="fa fa-check"></i><b>4.2.1</b> Colinéarité<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="exploration.html"><a href="exploration.html#standardisation-des-données"><i class="fa fa-check"></i><b>4.2.2</b> Standardisation des données<span></span></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Constrained ordinations<span></span></b></span></li>
<li class="chapter" data-level="5" data-path="que-sont-les-ordinations-contraintes.html"><a href="que-sont-les-ordinations-contraintes.html"><i class="fa fa-check"></i><b>5</b> Que sont les ordinations “contraintes” ?<span></span></a></li>
<li class="chapter" data-level="6" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html"><i class="fa fa-check"></i><b>6</b> Analyse canonique de redondances<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#computation"><i class="fa fa-check"></i><b>6.1</b> Computation<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#implémentation-dans-r"><i class="fa fa-check"></i><b>6.2</b> Implémentation dans R<span></span></a><ul>
<li class="chapter" data-level="6.2.1" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#sélection-de-variables"><i class="fa fa-check"></i><b>6.2.1</b> Sélection de variables<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#tester-la-significativité"><i class="fa fa-check"></i><b>6.2.2</b> Tester la significativité<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#représentation-graphique-des-rdas"><i class="fa fa-check"></i><b>6.2.3</b> Représentation graphique des RDAs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#défi-1"><i class="fa fa-check"></i><b>6.3</b> Défi 1<span></span></a><ul>
<li class="chapter" data-level="6.3.1" data-path="analyse-canonique-de-redondances.html"><a href="analyse-canonique-de-redondances.html#défi-1-solution"><i class="fa fa-check"></i><b>6.3.1</b> Défi 1: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rda-partielle.html"><a href="rda-partielle.html"><i class="fa fa-check"></i><b>7</b> RDA partielle<span></span></a><ul>
<li class="chapter" data-level="7.1" data-path="rda-partielle.html"><a href="rda-partielle.html#exemple-rda-partielle-sur-les-données-doubs"><i class="fa fa-check"></i><b>7.1</b> Exemple: RDA partielle sur les données Doubs<span></span></a><ul>
<li class="chapter" data-level="7.1.1" data-path="rda-partielle.html"><a href="rda-partielle.html#interprétation-de-la-sortie-dune-rda-partielle"><i class="fa fa-check"></i><b>7.1.1</b> Interprétation de la sortie d’une RDA partielle<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="rda-partielle.html"><a href="rda-partielle.html#tester-la-significativité-1"><i class="fa fa-check"></i><b>7.1.2</b> Tester la significativité<span></span></a></li>
<li class="chapter" data-level="7.1.3" data-path="rda-partielle.html"><a href="rda-partielle.html#représentation-graphique"><i class="fa fa-check"></i><b>7.1.3</b> Représentation graphique<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="rda-partielle.html"><a href="rda-partielle.html#défi-2"><i class="fa fa-check"></i><b>7.2</b> Défi 2<span></span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="rda-partielle.html"><a href="rda-partielle.html#défi-2-solution"><i class="fa fa-check"></i><b>7.2.1</b> Défi 2: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html"><i class="fa fa-check"></i><b>8</b> Partitionnement de la variation<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#partitionnement-de-la-variation-dans-r"><i class="fa fa-check"></i><b>8.1</b> Partitionnement de la variation dans R<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#tester-la-significativité-2"><i class="fa fa-check"></i><b>8.2</b> Tester la significativité<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#défi-3"><i class="fa fa-check"></i><b>8.3</b> Défi 3<span></span></a><ul>
<li class="chapter" data-level="8.3.1" data-path="partitionnement-de-la-variation.html"><a href="partitionnement-de-la-variation.html#défi-3-solution"><i class="fa fa-check"></i><b>8.3.1</b> Défi 3: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html"><i class="fa fa-check"></i><b>9</b> Arbre de régression multivarié<span></span></a><ul>
<li class="chapter" data-level="9.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#computation-1"><i class="fa fa-check"></i><b>9.1</b> Computation<span></span></a><ul>
<li class="chapter" data-level="9.1.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#construction-de-larbre-partitionnement-des-données-sous-contrainte"><i class="fa fa-check"></i><b>9.1.1</b> Construction de l’arbre: Partitionnement des données sous contrainte<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#sélection-de-larbre-validation-croisée-et-élagage-de-larbre"><i class="fa fa-check"></i><b>9.1.2</b> Sélection de l’arbre: Validation croisée et élagage de l’arbre<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#mrt-dans-r"><i class="fa fa-check"></i><b>9.2</b> MRT dans R<span></span></a><ul>
<li class="chapter" data-level="9.2.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#processus-de-sélection"><i class="fa fa-check"></i><b>9.2.1</b> Processus de sélection<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#interprétation-des-résultats"><i class="fa fa-check"></i><b>9.2.2</b> Interprétation des résultats<span></span></a></li>
<li class="chapter" data-level="9.2.3" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#indicator-species"><i class="fa fa-check"></i><b>9.2.3</b> Indicator species<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#défi-4"><i class="fa fa-check"></i><b>9.3</b> Défi 4<span></span></a><ul>
<li class="chapter" data-level="9.3.1" data-path="arbre-de-régression-multivarié.html"><a href="arbre-de-régression-multivarié.html#challenge-4-solution"><i class="fa fa-check"></i><b>9.3.1</b> Challenge 4: Solution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html"><i class="fa fa-check"></i><b>10</b> Analyse discriminante linéaire<span></span></a><ul>
<li class="chapter" data-level="10.1" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#lda-dans-r-rivière-doubs"><i class="fa fa-check"></i><b>10.1</b> LDA dans R: Rivière Doubs<span></span></a><ul>
<li class="chapter" data-level="10.1.1" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#créer-des-groupes-a-priori"><i class="fa fa-check"></i><b>10.1.1</b> Créer des groupes <em>a priori</em><span></span></a></li>
<li class="chapter" data-level="10.1.2" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#lda-dans-r"><i class="fa fa-check"></i><b>10.1.2</b> LDA dans R<span></span></a></li>
<li class="chapter" data-level="10.1.3" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#exactitude-du-groupement"><i class="fa fa-check"></i><b>10.1.3</b> Exactitude du groupement<span></span></a></li>
<li class="chapter" data-level="10.1.4" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#prédictions"><i class="fa fa-check"></i><b>10.1.4</b> Prédictions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="analyse-discriminante-linéaire.html"><a href="analyse-discriminante-linéaire.html#défi-5"><i class="fa fa-check"></i><b>10.2</b> Défi 5<span></span></a></li>
</ul></li>
<li class="part"><span><b>Considérations finales<span></span></b></span></li>
<li class="chapter" data-level="11" data-path="résumé.html"><a href="résumé.html"><i class="fa fa-check"></i><b>11</b> Résumé<span></span></a></li>
<li class="chapter" data-level="12" data-path="ressources-additionelles.html"><a href="ressources-additionelles.html"><i class="fa fa-check"></i><b>12</b> Ressources additionelles<span></span></a></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 10: Analyses multivariées avancées en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="rda-partielle" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapitre 7</span> RDA partielle<a href="rda-partielle.html#rda-partielle" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La RDA partielle est un cas particulier de la RDA qui permet de tenir compte de <strong>covariables</strong>. En d’autres mots, on peut modéliser les effets linéaires de la matrice <span class="math inline">\(X\)</span> sur la matrice <span class="math inline">\(Y\)</span>, tout en controllant pour l’effet d’une matrice de variables explicatives supplémentaires <span class="math inline">\(W\)</span>, appelées <strong>covariables</strong> (ou covariables). Comme dans la régression linéaire partielle, l’effet linéaire des variables <span class="math inline">\(X\)</span> sur les variables <span class="math inline">\(Y\)</span> est <em>ajusté</em> pour les effets des covariables <span class="math inline">\(W\)</span>. Pour cela, on effectue d’abord une RDA des covariables <span class="math inline">\(W\)</span> sur les variables de réponse <span class="math inline">\(Y\)</span>. On extrait ensuite les résidus de ce RDA, c’est-à-dire une matrice <span class="math inline">\(Y_{res}|W\)</span> contenant les variables réponses <span class="math inline">\(Y\)</span> dans lesquelles l’effet de <span class="math inline">\(W\)</span> a été retiré. La RDA partielle correspond à la RDA de <span class="math inline">\(X\)</span> sur <span class="math inline">\(Y_{res}|W\)</span>. Toutes les statistiques présentées précédemment pour la RDA s’appliquent également à la RDA partielle.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="images/PartialRDA.png" alt="The basic structure of a redundancy analysis (RDA)." width="70%" />
<p class="caption">
Figure 7.1: The basic structure of a redundancy analysis (RDA).
</p>
</div>
<p>La RDA partielle a plusieurs applications. C’est un outil puissant pour évaluer l’effet des variables environnementales sur la composition des espèces tout en tenant compte de la variation due à d’autres variables environnementales qui ne sont pas visées par l’étude. Un exemple courant de ceci en écologie des communautés est de tester l’importance des variables environnementales tout en contrôlant pour l’effet de l’espace. La RDA partielle peut également être utilisée pour contrôler des effets linéaires bien connus, ou pour isoler l’effet d’une seule variable explicative.</p>
<div id="exemple-rda-partielle-sur-les-données-doubs" class="section level2 hasAnchor">
<h2><span class="header-section-number">7.1</span> Exemple: RDA partielle sur les données Doubs<a href="rda-partielle.html#exemple-rda-partielle-sur-les-données-doubs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dans <code>R</code>, on peut faire une RDA partielle avec la fonction <code>rda()</code>. Par exemple, évaluons l’effet de la chimie de l’eau sur l’abondance des poissons (<code>spe.hel</code>) en tenant compte de covariables topographiques.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="rda-partielle.html#cb55-1"></a><span class="co"># Divisez le tableau de données environnementales en deux:</span></span>
<span id="cb55-2"><a href="rda-partielle.html#cb55-2"></a><span class="co"># variables topographiques et chimiques</span></span>
<span id="cb55-3"><a href="rda-partielle.html#cb55-3"></a>env.topo &lt;-<span class="st"> </span><span class="kw">subset</span>(env.z, <span class="dt">select =</span> <span class="kw">c</span>(alt, pen, deb))</span>
<span id="cb55-4"><a href="rda-partielle.html#cb55-4"></a>env.chem &lt;-<span class="st"> </span><span class="kw">subset</span>(env.z, <span class="dt">select =</span> <span class="kw">c</span>(pH, dur, pho, nit, amm,</span>
<span id="cb55-5"><a href="rda-partielle.html#cb55-5"></a>    oxy, dbo))</span>
<span id="cb55-6"><a href="rda-partielle.html#cb55-6"></a></span>
<span id="cb55-7"><a href="rda-partielle.html#cb55-7"></a><span class="co"># Faire la RDA partielle</span></span>
<span id="cb55-8"><a href="rda-partielle.html#cb55-8"></a>spe.partial.rda &lt;-<span class="st"> </span><span class="kw">rda</span>(spe.hel, env.chem, env.topo)</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> On peut aussi utiliser une syntaxe de formule comme <code>Y ~ X + Condition(W)</code>, où <code>Condition()</code> permet de tenir compete de covariables.</p>
</blockquote>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="rda-partielle.html#cb56-1"></a><span class="co"># Syntaxe alternative </span></span>
<span id="cb56-2"><a href="rda-partielle.html#cb56-2"></a>spe.partial.rda &lt;-<span class="st"> </span><span class="kw">rda</span>(spe.hel <span class="op">~</span><span class="st"> </span>pH <span class="op">+</span><span class="st"> </span>dur <span class="op">+</span><span class="st"> </span>pho <span class="op">+</span><span class="st"> </span>nit <span class="op">+</span><span class="st"> </span>amm <span class="op">+</span><span class="st"> </span>oxy <span class="op">+</span><span class="st"> </span>dbo <span class="op">+</span></span>
<span id="cb56-3"><a href="rda-partielle.html#cb56-3"></a><span class="st">                       </span><span class="kw">Condition</span>(alt <span class="op">+</span><span class="st"> </span>pen <span class="op">+</span><span class="st"> </span>deb), <span class="co"># covariables ici</span></span>
<span id="cb56-4"><a href="rda-partielle.html#cb56-4"></a>                       <span class="dt">data =</span> env.z)</span></code></pre></div>
<div id="interprétation-de-la-sortie-dune-rda-partielle" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.1.1</span> Interprétation de la sortie d’une RDA partielle<a href="rda-partielle.html#interprétation-de-la-sortie-dune-rda-partielle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le résultat d’une RDA partielle est très similaire à celui présenté dans la section précédente sur la RDA. La principale différence est que nous avons des covariables dans notre modèle, ce qui signifie que nous pouvons déterminer la proportion de la variation expliquée par ces variables supplémentaires, mais qui ne sont pas “<em>intéressantes</em>”. Encore une fois, la première section du résumé contient les éléments dont nous avons besoin pour vérifier la performance de notre RDA partielle.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="rda-partielle.html#cb57-1"></a><span class="kw">summary</span>(spe.partial.rda)</span></code></pre></div>
<pre><code>...
## Partitioning of variance:
##               Inertia Proportion
## Total          0.5025     1.0000
## Conditioned    0.2087     0.4153
## Constrained    0.1602     0.3189
## Unconstrained  0.1336     0.2659
...</code></pre>
<ul>
<li><strong>Conditioned Proportion</strong>: variance de <span class="math inline">\(Y\)</span> expliquée par <span class="math inline">\(W\)</span> <strong>(41.53%)</strong></li>
<li><strong>Constrained Proportion</strong>: variance de <span class="math inline">\(Y\)</span> expliquée par <span class="math inline">\(X\)</span> <strong>(31.89%)</strong></li>
<li><strong>Unconstained Proportion</strong>: variance de <span class="math inline">\(Y\)</span> non expliquée <strong>(26.59%)</strong></li>
</ul>
<blockquote>
<p>Comment présenteriez-vous ces résultats? La chimie de l’eau explique <strong>31.89%</strong> de l’abondance des espèces de poissons, tandis que la topographie explique <strong>41.53%</strong> de la variation en abondances des poissons.</p>
</blockquote>
</div>
<div id="tester-la-significativité-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.1.2</span> Tester la significativité<a href="rda-partielle.html#tester-la-significativité-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comme pour le RDA, nous pouvons interpréter la signification de notre modèle à l’aide de deux informations clés.</p>
<ol style="list-style-type: decimal">
<li>Quel est le <strong>pouvoir explicatif</strong> du modèle ?</li>
</ol>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="rda-partielle.html#cb59-1"></a><span class="co"># Extraire le R2 ajusté du modèle</span></span>
<span id="cb59-2"><a href="rda-partielle.html#cb59-2"></a><span class="kw">RsquareAdj</span>(spe.partial.rda)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.2413464</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Est-ce que le modèle est <strong>significatif</strong>?</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="rda-partielle.html#cb61-1"></a><span class="co"># Évaluer la significativité statistique du modèle</span></span>
<span id="cb61-2"><a href="rda-partielle.html#cb61-2"></a><span class="kw">anova.cca</span>(spe.partial.rda, <span class="dt">step =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>...
## Permutation test for rda under reduced model
## Number of permutations: 999
## 
## Model: rda(X = spe.hel, Y = env.chem, Z = env.topo)
##          Df Variance      F Pr(&gt;F)    
## Model     7  0.16024 3.0842  0.001 ***
## Residual 18  0.13360                  
...</code></pre>
<blockquote>
<p>Notre modèle explique 24.1% de la variation en abondance de poissons entre sites. Il est aussi statistiquement significatif (p = 0.001)!</p>
</blockquote>
</div>
<div id="représentation-graphique" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.1.3</span> Représentation graphique<a href="rda-partielle.html#représentation-graphique" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On peut visualiser les effets des variables environnementales sur la communauté de poissons avec la fonction <code>ordiplot()</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="rda-partielle.html#cb63-1"></a><span class="kw">ordiplot</span>(spe.partial.rda, <span class="dt">scaling =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&quot;Rivière Doubs - Cadrage 2&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-45-1.png" width="432" /></p>
<blockquote>
<p>Recall: Le cadrage de type 2 montre les effets des variables explicatives, donc de la matrice X sur la matrice Y une fois qu’on a controllé pour l’effet des covariables W.</p>
</blockquote>
<div class="puzzle">
<p><strong>Note:</strong> <em>Les variables topographiques ne sont pas représentées. Pourquoi?</em></p>
<p>Le RDA partiel ne fait qu’<em>ajuster</em> les effets des variables explicatives en fonction des covariables. Les covariables ne sont pas <em>d’intérêt</em>, et ne sont donc pas représentées graphiquement.</p>
</div>
</div>
</div>
<div id="défi-2" class="section level2 hasAnchor">
<h2><span class="header-section-number">7.2</span> Défi 2<a href="rda-partielle.html#défi-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Effectuez une RDA partielle de l’abondance des espèces de mites (<code>mite.spe.hel</code>) en fonction des variables environnementales, tenant compte de l’effet du substrat (<code>SubsDens</code>, <code>WaterCont</code> and <code>Substrate</code>).
* Quel pourcentage de variance est expliqué par les variables environnementales?
* Le modèle est-il significatif?
* Quels sont les axes significatifs?</p>
<p>Rappel des données et fonctions utiles:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="rda-partielle.html#cb64-1"></a><span class="kw">rda</span>()</span>
<span id="cb64-2"><a href="rda-partielle.html#cb64-2"></a><span class="kw">summary</span>()</span>
<span id="cb64-3"><a href="rda-partielle.html#cb64-3"></a><span class="kw">RsquareAdj</span>()</span>
<span id="cb64-4"><a href="rda-partielle.html#cb64-4"></a><span class="kw">anova.cca</span>()  <span class="co"># voir l&#39;argument &#39;by&#39; dans ?anova.cca</span></span></code></pre></div>
<div id="défi-2-solution" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.2.1</span> Défi 2: Solution<a href="rda-partielle.html#défi-2-solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Étape 1:</strong> Transformer et standardiser les données.</p>
<p>Nos données sont déjà transformés et standardisés!</p>
<p><strong>Étape 2:</strong> Faire la RDA partielle:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="rda-partielle.html#cb65-1"></a>mite.spe.subs &lt;-<span class="st"> </span><span class="kw">rda</span>(mite.spe.hel <span class="op">~</span><span class="st"> </span>Shrub <span class="op">+</span><span class="st"> </span>Topo <span class="op">+</span><span class="st"> </span><span class="kw">Condition</span>(SubsDens <span class="op">+</span></span>
<span id="cb65-2"><a href="rda-partielle.html#cb65-2"></a><span class="st">    </span>WatrCont <span class="op">+</span><span class="st"> </span>Substrate), <span class="dt">data =</span> mite.env)</span>
<span id="cb65-3"><a href="rda-partielle.html#cb65-3"></a></span>
<span id="cb65-4"><a href="rda-partielle.html#cb65-4"></a><span class="co"># Extraire les résultats</span></span>
<span id="cb65-5"><a href="rda-partielle.html#cb65-5"></a><span class="kw">summary</span>(mite.spe.subs)</span></code></pre></div>
<pre><code>...
## Partitioning of variance:
##               Inertia Proportion
## Total         0.39428    1.00000
## Conditioned   0.16891    0.42839
## Constrained   0.03868    0.09811
## Unconstrained 0.18669    0.47350
...</code></pre>
<blockquote>
<p>Shrub et Topo expliquent <strong>9.8%</strong> de la variation de l’abondance de mites, tandis que le substrat explique <strong>42.8%</strong> de cette variation.</p>
</blockquote>
<p><strong>Étape 3:</strong> Interpréter les résultats!</p>
<ul>
<li>Quel pourcentage de variance est expliqué par les variables environnementales?</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="rda-partielle.html#cb67-1"></a><span class="kw">RsquareAdj</span>(mite.spe.subs)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.08327533</code></pre>
<ul>
<li>Le modèle est-il significatif?</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="rda-partielle.html#cb69-1"></a><span class="kw">anova.cca</span>(mite.spe.subs, <span class="dt">step =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## Permutation test for rda under reduced model
## Permutation: free
## Number of permutations: 999
## 
## Model: rda(formula = mite.spe.hel ~ Shrub + Topo + Condition(SubsDens + WatrCont + Substrate), data = mite.env)
##          Df Variance     F Pr(&gt;F)    
## Model     3 0.038683 4.006  0.001 ***
## Residual 58 0.186688                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>Quels axes sont significatifs?</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="rda-partielle.html#cb71-1"></a><span class="kw">anova.cca</span>(mite.spe.subs, <span class="dt">step =</span> <span class="dv">1000</span>, <span class="dt">by =</span> <span class="st">&quot;axis&quot;</span>)</span></code></pre></div>
<pre><code>## Permutation test for rda under reduced model
## Forward tests for axes
## Permutation: free
## Number of permutations: 999
## 
## Model: rda(formula = mite.spe.hel ~ Shrub + Topo + Condition(SubsDens + WatrCont + Substrate), data = mite.env)
##          Df Variance      F Pr(&gt;F)    
## RDA1      1 0.027236 8.4618  0.001 ***
## RDA2      1 0.008254 2.5643  0.022 *  
## RDA3      1 0.003193 0.9919  0.423    
## Residual 58 0.186688                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<blockquote>
<p>Le <span class="math inline">\(R^2\)</span> ajusté de la RDA globale est <strong>8.33%</strong>, et est significatif (p = 0.001). Les variables environnementales expliquent <strong>9.81%</strong> de la variance de la composition des espèces d’acariens entre les sites, tandis que les covariables du substrat expliquent <strong>42.84%</strong> de cette variation. Cependant, <strong>47.35%</strong> de la variation reste inexpliquée. Les deux premiers axes canoniques sont significatifs.</p>
</blockquote>

</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="analyse-canonique-de-redondances.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="partitionnement-de-la-variation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
